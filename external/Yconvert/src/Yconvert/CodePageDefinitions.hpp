//****************************************************************************
// Copyright Â© 2020 Jan Erik Breimo. All rights reserved.
// Created by Jan Erik Breimo on 2020-07-14
//
// This file is distributed under the Simplified BSD License.
// License text is included with the source distribution.
//****************************************************************************
#pragma once

#include <array>
#include "Yconvert/Encoding.hpp"

namespace Yconvert
{
    struct CodePageRange
    {
        uint16_t startCodePoint;
        uint8_t startIndex;
        uint8_t length;
    };

    #ifdef YCONVERT_ENABLE_ISO_CODE_PAGES

    constexpr CodePageRange ISO_8859_1_CHARS[] = {
        {0x0000,   0, 255}
    };

    constexpr CodePageRange ISO_8859_2_CHARS[] = {
        {0x0000,   0, 160}, {0x00A4, 164,   0}, {0x00A7, 167,   1},
        {0x00AD, 173,   0}, {0x00B0, 176,   0}, {0x00B4, 180,   0},
        {0x00B8, 184,   0}, {0x00C1, 193,   1}, {0x00C4, 196,   0},
        {0x00C7, 199,   0}, {0x00C9, 201,   0}, {0x00CB, 203,   0},
        {0x00CD, 205,   1}, {0x00D3, 211,   1}, {0x00D6, 214,   1},
        {0x00DA, 218,   0}, {0x00DC, 220,   1}, {0x00DF, 223,   0},
        {0x00E1, 225,   1}, {0x00E4, 228,   0}, {0x00E7, 231,   0},
        {0x00E9, 233,   0}, {0x00EB, 235,   0}, {0x00ED, 237,   1},
        {0x00F3, 243,   1}, {0x00F6, 246,   1}, {0x00FA, 250,   0},
        {0x00FC, 252,   1}, {0x0102, 195,   0}, {0x0103, 227,   0},
        {0x0104, 161,   0}, {0x0105, 177,   0}, {0x0106, 198,   0},
        {0x0107, 230,   0}, {0x010C, 200,   0}, {0x010D, 232,   0},
        {0x010E, 207,   0}, {0x010F, 239,   0}, {0x0110, 208,   0},
        {0x0111, 240,   0}, {0x0118, 202,   0}, {0x0119, 234,   0},
        {0x011A, 204,   0}, {0x011B, 236,   0}, {0x0139, 197,   0},
        {0x013A, 229,   0}, {0x013D, 165,   0}, {0x013E, 181,   0},
        {0x0141, 163,   0}, {0x0142, 179,   0}, {0x0143, 209,   0},
        {0x0144, 241,   0}, {0x0147, 210,   0}, {0x0148, 242,   0},
        {0x0150, 213,   0}, {0x0151, 245,   0}, {0x0154, 192,   0},
        {0x0155, 224,   0}, {0x0158, 216,   0}, {0x0159, 248,   0},
        {0x015A, 166,   0}, {0x015B, 182,   0}, {0x015E, 170,   0},
        {0x015F, 186,   0}, {0x0160, 169,   0}, {0x0161, 185,   0},
        {0x0162, 222,   0}, {0x0163, 254,   0}, {0x0164, 171,   0},
        {0x0165, 187,   0}, {0x016E, 217,   0}, {0x016F, 249,   0},
        {0x0170, 219,   0}, {0x0171, 251,   0}, {0x0179, 172,   0},
        {0x017A, 188,   0}, {0x017B, 175,   0}, {0x017C, 191,   0},
        {0x017D, 174,   0}, {0x017E, 190,   0}, {0x02C7, 183,   0},
        {0x02D8, 162,   0}, {0x02D9, 255,   0}, {0x02DB, 178,   0},
        {0x02DD, 189,   0}
    };

    constexpr CodePageRange ISO_8859_3_CHARS[] = {
        {0x0000,   0, 160}, {0x00A3, 163,   1}, {0x00A7, 167,   1},
        {0x00AD, 173,   0}, {0x00B0, 176,   0}, {0x00B2, 178,   3},
        {0x00B7, 183,   1}, {0x00BD, 189,   0}, {0x00C0, 192,   2},
        {0x00C4, 196,   0}, {0x00C7, 199,   8}, {0x00D1, 209,   3},
        {0x00D6, 214,   1}, {0x00D9, 217,   3}, {0x00DF, 223,   3},
        {0x00E4, 228,   0}, {0x00E7, 231,   8}, {0x00F1, 241,   3},
        {0x00F6, 246,   1}, {0x00F9, 249,   3}, {0x0108, 198,   0},
        {0x0109, 230,   0}, {0x010A, 197,   0}, {0x010B, 229,   0},
        {0x011C, 216,   0}, {0x011D, 248,   0}, {0x011E, 171,   0},
        {0x011F, 187,   0}, {0x0120, 213,   0}, {0x0121, 245,   0},
        {0x0124, 166,   0}, {0x0125, 182,   0}, {0x0126, 161,   0},
        {0x0127, 177,   0}, {0x0130, 169,   0}, {0x0131, 185,   0},
        {0x0134, 172,   0}, {0x0135, 188,   0}, {0x015C, 222,   0},
        {0x015D, 254,   0}, {0x015E, 170,   0}, {0x015F, 186,   0},
        {0x016C, 221,   0}, {0x016D, 253,   0}, {0x017B, 175,   0},
        {0x017C, 191,   0}, {0x02D8, 162,   0}, {0x02D9, 255,   0}
    };

    constexpr CodePageRange ISO_8859_4_CHARS[] = {
        {0x0000,   0, 160}, {0x00A4, 164,   0}, {0x00A7, 167,   1},
        {0x00AD, 173,   0}, {0x00AF, 175,   1}, {0x00B4, 180,   0},
        {0x00B8, 184,   0}, {0x00C1, 193,   5}, {0x00C9, 201,   0},
        {0x00CB, 203,   0}, {0x00CD, 205,   1}, {0x00D4, 212,   4},
        {0x00DA, 218,   2}, {0x00DF, 223,   0}, {0x00E1, 225,   5},
        {0x00E9, 233,   0}, {0x00EB, 235,   0}, {0x00ED, 237,   1},
        {0x00F4, 244,   4}, {0x00FA, 250,   2}, {0x0100, 192,   0},
        {0x0101, 224,   0}, {0x0104, 161,   0}, {0x0105, 177,   0},
        {0x010C, 200,   0}, {0x010D, 232,   0}, {0x0110, 208,   0},
        {0x0111, 240,   0}, {0x0112, 170,   0}, {0x0113, 186,   0},
        {0x0116, 204,   0}, {0x0117, 236,   0}, {0x0118, 202,   0},
        {0x0119, 234,   0}, {0x0122, 171,   0}, {0x0123, 187,   0},
        {0x0128, 165,   0}, {0x0129, 181,   0}, {0x012A, 207,   0},
        {0x012B, 239,   0}, {0x012E, 199,   0}, {0x012F, 231,   0},
        {0x0136, 211,   0}, {0x0137, 243,   0}, {0x0138, 162,   0},
        {0x013B, 166,   0}, {0x013C, 182,   0}, {0x0145, 209,   0},
        {0x0146, 241,   0}, {0x014A, 189,   0}, {0x014B, 191,   0},
        {0x014C, 210,   0}, {0x014D, 242,   0}, {0x0156, 163,   0},
        {0x0157, 179,   0}, {0x0160, 169,   0}, {0x0161, 185,   0},
        {0x0166, 172,   0}, {0x0167, 188,   0}, {0x0168, 221,   0},
        {0x0169, 253,   0}, {0x016A, 222,   0}, {0x016B, 254,   0},
        {0x0172, 217,   0}, {0x0173, 249,   0}, {0x017D, 174,   0},
        {0x017E, 190,   0}, {0x02C7, 183,   0}, {0x02D9, 255,   0},
        {0x02DB, 178,   0}
    };

    constexpr CodePageRange ISO_8859_5_CHARS[] = {
        {0x0000,   0, 160}, {0x00A7, 253,   0}, {0x00AD, 173,   0},
        {0x0401, 161,  11}, {0x040E, 174,  65}, {0x0451, 241,  11},
        {0x045E, 254,   1}, {0x2116, 240,   0}
    };

    constexpr CodePageRange ISO_8859_6_CHARS[] = {
        {0x0000,   0, 160}, {0x00A4, 164,   0}, {0x00AD, 173,   0},
        {0x060C, 172,   0}, {0x061B, 187,   0}, {0x061F, 191,   0},
        {0x0621, 193,  25}, {0x0640, 224,  18}
    };

    constexpr CodePageRange ISO_8859_7_CHARS[] = {
        {0x0000,   0, 160}, {0x00A3, 163,   0}, {0x00A6, 166,   3},
        {0x00AB, 171,   2}, {0x00B0, 176,   3}, {0x00B7, 183,   0},
        {0x00BB, 187,   0}, {0x00BD, 189,   0}, {0x037A, 170,   0},
        {0x0384, 180,   2}, {0x0388, 184,   2}, {0x038C, 188,   0},
        {0x038E, 190,  19}, {0x03A3, 211,  43}, {0x2015, 175,   0},
        {0x2018, 161,   1}, {0x20AC, 164,   0}, {0x20AF, 165,   0}
    };

    constexpr CodePageRange ISO_8859_8_CHARS[] = {
        {0x0000,   0, 160}, {0x00A2, 162,   7}, {0x00AB, 171,  14},
        {0x00BB, 187,   3}, {0x00D7, 170,   0}, {0x00F7, 186,   0},
        {0x05D0, 224,  26}, {0x200E, 253,   1}, {0x2017, 223,   0}
    };

    constexpr CodePageRange ISO_8859_9_CHARS[] = {
        {0x0000,   0, 207}, {0x00D1, 209,  11}, {0x00DF, 223,  16},
        {0x00F1, 241,  11}, {0x00FF, 255,   0}, {0x011E, 208,   0},
        {0x011F, 240,   0}, {0x0130, 221,   0}, {0x0131, 253,   0},
        {0x015E, 222,   0}, {0x015F, 254,   0}
    };

    constexpr CodePageRange ISO_8859_10_CHARS[] = {
        {0x0000,   0, 160}, {0x00A7, 167,   0}, {0x00AD, 173,   0},
        {0x00B0, 176,   0}, {0x00B7, 183,   0}, {0x00C1, 193,   5},
        {0x00C9, 201,   0}, {0x00CB, 203,   0}, {0x00CD, 205,   3},
        {0x00D3, 211,   3}, {0x00D8, 216,   0}, {0x00DA, 218,   5},
        {0x00E1, 225,   5}, {0x00E9, 233,   0}, {0x00EB, 235,   0},
        {0x00ED, 237,   3}, {0x00F3, 243,   3}, {0x00F8, 248,   0},
        {0x00FA, 250,   4}, {0x0100, 192,   0}, {0x0101, 224,   0},
        {0x0104, 161,   0}, {0x0105, 177,   0}, {0x010C, 200,   0},
        {0x010D, 232,   0}, {0x0110, 169,   0}, {0x0111, 185,   0},
        {0x0112, 162,   0}, {0x0113, 178,   0}, {0x0116, 204,   0},
        {0x0117, 236,   0}, {0x0118, 202,   0}, {0x0119, 234,   0},
        {0x0122, 163,   0}, {0x0123, 179,   0}, {0x0128, 165,   0},
        {0x0129, 181,   0}, {0x012A, 164,   0}, {0x012B, 180,   0},
        {0x012E, 199,   0}, {0x012F, 231,   0}, {0x0136, 166,   0},
        {0x0137, 182,   0}, {0x0138, 255,   0}, {0x013B, 168,   0},
        {0x013C, 184,   0}, {0x0145, 209,   0}, {0x0146, 241,   0},
        {0x014A, 175,   0}, {0x014B, 191,   0}, {0x014C, 210,   0},
        {0x014D, 242,   0}, {0x0160, 170,   0}, {0x0161, 186,   0},
        {0x0166, 171,   0}, {0x0167, 187,   0}, {0x0168, 215,   0},
        {0x0169, 247,   0}, {0x016A, 174,   0}, {0x016B, 190,   0},
        {0x0172, 217,   0}, {0x0173, 249,   0}, {0x017D, 172,   0},
        {0x017E, 188,   0}, {0x2015, 189,   0}
    };

    constexpr CodePageRange ISO_8859_11_CHARS[] = {
        {0x0000,   0, 160}, {0x0E01, 161,  57}, {0x0E3F, 223,  28}
    };

    constexpr CodePageRange ISO_8859_13_CHARS[] = {
        {0x0000,   0, 160}, {0x00A2, 162,   2}, {0x00A6, 166,   1},
        {0x00A9, 169,   0}, {0x00AB, 171,   3}, {0x00B0, 176,   3},
        {0x00B5, 181,   2}, {0x00B9, 185,   0}, {0x00BB, 187,   3},
        {0x00C4, 196,   1}, {0x00C6, 175,   0}, {0x00C9, 201,   0},
        {0x00D3, 211,   0}, {0x00D5, 213,   2}, {0x00D8, 168,   0},
        {0x00DC, 220,   0}, {0x00DF, 223,   0}, {0x00E4, 228,   1},
        {0x00E6, 191,   0}, {0x00E9, 233,   0}, {0x00F3, 243,   0},
        {0x00F5, 245,   2}, {0x00F8, 184,   0}, {0x00FC, 252,   0},
        {0x0100, 194,   0}, {0x0101, 226,   0}, {0x0104, 192,   0},
        {0x0105, 224,   0}, {0x0106, 195,   0}, {0x0107, 227,   0},
        {0x010C, 200,   0}, {0x010D, 232,   0}, {0x0112, 199,   0},
        {0x0113, 231,   0}, {0x0116, 203,   0}, {0x0117, 235,   0},
        {0x0118, 198,   0}, {0x0119, 230,   0}, {0x0122, 204,   0},
        {0x0123, 236,   0}, {0x012A, 206,   0}, {0x012B, 238,   0},
        {0x012E, 193,   0}, {0x012F, 225,   0}, {0x0136, 205,   0},
        {0x0137, 237,   0}, {0x013B, 207,   0}, {0x013C, 239,   0},
        {0x0141, 217,   0}, {0x0142, 249,   0}, {0x0143, 209,   0},
        {0x0144, 241,   0}, {0x0145, 210,   0}, {0x0146, 242,   0},
        {0x014C, 212,   0}, {0x014D, 244,   0}, {0x0156, 170,   0},
        {0x0157, 186,   0}, {0x015A, 218,   0}, {0x015B, 250,   0},
        {0x0160, 208,   0}, {0x0161, 240,   0}, {0x016A, 219,   0},
        {0x016B, 251,   0}, {0x0172, 216,   0}, {0x0173, 248,   0},
        {0x0179, 202,   0}, {0x017A, 234,   0}, {0x017B, 221,   0},
        {0x017C, 253,   0}, {0x017D, 222,   0}, {0x017E, 254,   0},
        {0x2019, 255,   0}, {0x201C, 180,   0}, {0x201D, 161,   0},
        {0x201E, 165,   0}
    };

    constexpr CodePageRange ISO_8859_14_CHARS[] = {
        {0x0000,   0, 160}, {0x00A3, 163,   0}, {0x00A7, 167,   0},
        {0x00A9, 169,   0}, {0x00AD, 173,   1}, {0x00B6, 182,   0},
        {0x00C0, 192,  15}, {0x00D1, 209,   5}, {0x00D8, 216,   5},
        {0x00DF, 223,  16}, {0x00F1, 241,   5}, {0x00F8, 248,   5},
        {0x00FF, 255,   0}, {0x010A, 164,   1}, {0x0120, 178,   1},
        {0x0174, 208,   0}, {0x0175, 240,   0}, {0x0176, 222,   0},
        {0x0177, 254,   0}, {0x0178, 175,   0}, {0x1E02, 161,   1},
        {0x1E0A, 166,   0}, {0x1E0B, 171,   0}, {0x1E1E, 176,   1},
        {0x1E40, 180,   1}, {0x1E56, 183,   0}, {0x1E57, 185,   0},
        {0x1E60, 187,   0}, {0x1E61, 191,   0}, {0x1E6A, 215,   0},
        {0x1E6B, 247,   0}, {0x1E80, 168,   0}, {0x1E81, 184,   0},
        {0x1E82, 170,   0}, {0x1E83, 186,   0}, {0x1E84, 189,   1},
        {0x1EF2, 172,   0}, {0x1EF3, 188,   0}
    };

    constexpr CodePageRange ISO_8859_15_CHARS[] = {
        {0x0000,   0, 163}, {0x00A5, 165,   0}, {0x00A7, 167,   0},
        {0x00A9, 169,  10}, {0x00B5, 181,   2}, {0x00B9, 185,   2},
        {0x00BF, 191,  64}, {0x0152, 188,   1}, {0x0160, 166,   0},
        {0x0161, 168,   0}, {0x0178, 190,   0}, {0x017D, 180,   0},
        {0x017E, 184,   0}, {0x20AC, 164,   0}
    };

    constexpr CodePageRange ISO_8859_16_CHARS[] = {
        {0x0000,   0, 160}, {0x00A7, 167,   0}, {0x00A9, 169,   0},
        {0x00AB, 171,   0}, {0x00AD, 173,   0}, {0x00B0, 176,   1},
        {0x00B6, 182,   1}, {0x00BB, 187,   0}, {0x00C0, 192,   2},
        {0x00C4, 196,   0}, {0x00C6, 198,   9}, {0x00D2, 210,   2},
        {0x00D6, 214,   0}, {0x00D9, 217,   3}, {0x00DF, 223,   3},
        {0x00E4, 228,   0}, {0x00E6, 230,   9}, {0x00F2, 242,   2},
        {0x00F6, 246,   0}, {0x00F9, 249,   3}, {0x00FF, 255,   0},
        {0x0102, 195,   0}, {0x0103, 227,   0}, {0x0104, 161,   1},
        {0x0106, 197,   0}, {0x0107, 229,   0}, {0x010C, 178,   0},
        {0x010D, 185,   0}, {0x0110, 208,   0}, {0x0111, 240,   0},
        {0x0118, 221,   0}, {0x0119, 253,   0}, {0x0141, 163,   0},
        {0x0142, 179,   0}, {0x0143, 209,   0}, {0x0144, 241,   0},
        {0x0150, 213,   0}, {0x0151, 245,   0}, {0x0152, 188,   1},
        {0x015A, 215,   0}, {0x015B, 247,   0}, {0x0160, 166,   0},
        {0x0161, 168,   0}, {0x0170, 216,   0}, {0x0171, 248,   0},
        {0x0178, 190,   0}, {0x0179, 172,   0}, {0x017A, 174,   1},
        {0x017C, 191,   0}, {0x017D, 180,   0}, {0x017E, 184,   0},
        {0x0218, 170,   0}, {0x0219, 186,   0}, {0x021A, 222,   0},
        {0x021B, 254,   0}, {0x201D, 181,   0}, {0x201E, 165,   0},
        {0x20AC, 164,   0}
    };

    inline std::pair<const CodePageRange*, size_t>
    getIsoCodePageRanges(Encoding encoding)
    {
        switch (encoding)
        {
        case Encoding::ISO_8859_1:
            return {ISO_8859_1_CHARS, std::size(ISO_8859_1_CHARS)};
        case Encoding::ISO_8859_2:
            return {ISO_8859_2_CHARS, std::size(ISO_8859_2_CHARS)};
        case Encoding::ISO_8859_3:
            return {ISO_8859_3_CHARS, std::size(ISO_8859_3_CHARS)};
        case Encoding::ISO_8859_4:
            return {ISO_8859_4_CHARS, std::size(ISO_8859_4_CHARS)};
        case Encoding::ISO_8859_5:
            return {ISO_8859_5_CHARS, std::size(ISO_8859_5_CHARS)};
        case Encoding::ISO_8859_6:
            return {ISO_8859_6_CHARS, std::size(ISO_8859_6_CHARS)};
        case Encoding::ISO_8859_7:
            return {ISO_8859_7_CHARS, std::size(ISO_8859_7_CHARS)};
        case Encoding::ISO_8859_8:
            return {ISO_8859_8_CHARS, std::size(ISO_8859_8_CHARS)};
        case Encoding::ISO_8859_9:
            return {ISO_8859_9_CHARS, std::size(ISO_8859_9_CHARS)};
        case Encoding::ISO_8859_10:
            return {ISO_8859_10_CHARS, std::size(ISO_8859_10_CHARS)};
        case Encoding::ISO_8859_11:
            return {ISO_8859_11_CHARS, std::size(ISO_8859_11_CHARS)};
        case Encoding::ISO_8859_13:
            return {ISO_8859_13_CHARS, std::size(ISO_8859_13_CHARS)};
        case Encoding::ISO_8859_14:
            return {ISO_8859_14_CHARS, std::size(ISO_8859_14_CHARS)};
        case Encoding::ISO_8859_15:
            return {ISO_8859_15_CHARS, std::size(ISO_8859_15_CHARS)};
        case Encoding::ISO_8859_16:
            return {ISO_8859_16_CHARS, std::size(ISO_8859_16_CHARS)};
        default:
            return {nullptr, 0};
        }
    }

    #endif

    #ifdef YCONVERT_ENABLE_MAC_CODE_PAGES

    constexpr CodePageRange MAC_CYRILLIC_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 202,   0}, {0x00A2, 162,   1},
        {0x00A4, 255,   0}, {0x00A7, 164,   0}, {0x00A9, 169,   0},
        {0x00AB, 199,   0}, {0x00AC, 194,   0}, {0x00AE, 168,   0},
        {0x00B0, 161,   0}, {0x00B1, 177,   0}, {0x00B5, 181,   0},
        {0x00B6, 166,   0}, {0x00BB, 200,   0}, {0x00F7, 214,   0},
        {0x0192, 196,   0}, {0x0401, 221,   0}, {0x0402, 171,   0},
        {0x0403, 174,   0}, {0x0404, 184,   0}, {0x0405, 193,   0},
        {0x0406, 167,   0}, {0x0407, 186,   0}, {0x0408, 183,   0},
        {0x0409, 188,   0}, {0x040A, 190,   0}, {0x040B, 203,   0},
        {0x040C, 205,   0}, {0x040E, 216,   0}, {0x040F, 218,   0},
        {0x0410, 128,  31}, {0x0430, 224,  30}, {0x044F, 223,   0},
        {0x0451, 222,   0}, {0x0452, 172,   0}, {0x0453, 175,   0},
        {0x0454, 185,   0}, {0x0455, 207,   0}, {0x0456, 180,   0},
        {0x0457, 187,   0}, {0x0458, 192,   0}, {0x0459, 189,   0},
        {0x045A, 191,   0}, {0x045B, 204,   0}, {0x045C, 206,   0},
        {0x045E, 217,   0}, {0x045F, 219,   0}, {0x2013, 208,   1},
        {0x2018, 212,   1}, {0x201C, 210,   1}, {0x201E, 215,   0},
        {0x2020, 160,   0}, {0x2022, 165,   0}, {0x2026, 201,   0},
        {0x2116, 220,   0}, {0x2122, 170,   0}, {0x2202, 182,   0},
        {0x2206, 198,   0}, {0x221A, 195,   0}, {0x221E, 176,   0},
        {0x2248, 197,   0}, {0x2260, 173,   0}, {0x2264, 178,   1}
    };

    constexpr CodePageRange MAC_GREEK_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 202,   0}, {0x00A3, 146,   0},
        {0x00A5, 180,   0}, {0x00A6, 155,   0}, {0x00A7, 172,   0},
        {0x00A8, 140,   0}, {0x00A9, 169,   0}, {0x00AB, 199,   0},
        {0x00AC, 194,   0}, {0x00AD, 156,   0}, {0x00AE, 168,   0},
        {0x00B0, 174,   0}, {0x00B1, 177,   0}, {0x00B2, 130,   0},
        {0x00B3, 132,   0}, {0x00B9, 129,   0}, {0x00BB, 200,   0},
        {0x00BD, 151,   0}, {0x00C4, 128,   0}, {0x00C9, 131,   0},
        {0x00D6, 133,   0}, {0x00DC, 134,   0}, {0x00DF, 167,   0},
        {0x00E0, 136,   0}, {0x00E2, 137,   0}, {0x00E4, 138,   0},
        {0x00E7, 141,   0}, {0x00E8, 143,   0}, {0x00E9, 142,   0},
        {0x00EA, 144,   1}, {0x00EE, 148,   1}, {0x00F4, 153,   0},
        {0x00F6, 154,   0}, {0x00F7, 214,   0}, {0x00F9, 157,   0},
        {0x00FB, 158,   1}, {0x0153, 207,   0}, {0x0384, 139,   0},
        {0x0385, 135,   0}, {0x0386, 205,   0}, {0x0387, 175,   0},
        {0x0388, 206,   0}, {0x0389, 215,   1}, {0x038C, 217,   0},
        {0x038E, 218,   0}, {0x038F, 223,   0}, {0x0390, 253,   0},
        {0x0391, 176,   0}, {0x0392, 181,   0}, {0x0393, 161,   1},
        {0x0395, 182,   2}, {0x0398, 163,   0}, {0x0399, 185,   1},
        {0x039B, 164,   0}, {0x039C, 187,   0}, {0x039D, 193,   0},
        {0x039E, 165,   0}, {0x039F, 195,   0}, {0x03A0, 166,   0},
        {0x03A1, 196,   0}, {0x03A3, 170,   0}, {0x03A4, 198,   0},
        {0x03A5, 203,   0}, {0x03A6, 188,   0}, {0x03A7, 204,   0},
        {0x03A8, 190,   1}, {0x03AA, 171,   0}, {0x03AB, 189,   0},
        {0x03AC, 192,   0}, {0x03AD, 219,   2}, {0x03B0, 254,   0},
        {0x03B1, 225,   1}, {0x03B3, 231,   0}, {0x03B4, 228,   1},
        {0x03B6, 250,   0}, {0x03B7, 232,   0}, {0x03B8, 245,   0},
        {0x03B9, 233,   0}, {0x03BA, 235,   3}, {0x03BE, 234,   0},
        {0x03BF, 239,   1}, {0x03C1, 242,   0}, {0x03C2, 247,   0},
        {0x03C3, 243,   1}, {0x03C5, 249,   0}, {0x03C6, 230,   0},
        {0x03C7, 248,   0}, {0x03C8, 227,   0}, {0x03C9, 246,   0},
        {0x03CA, 251,   1}, {0x03CC, 222,   0}, {0x03CD, 224,   0},
        {0x03CE, 241,   0}, {0x2013, 208,   0}, {0x2015, 209,   0},
        {0x2018, 212,   1}, {0x201C, 210,   1}, {0x2020, 160,   0},
        {0x2022, 150,   0}, {0x2026, 201,   0}, {0x2030, 152,   0},
        {0x2122, 147,   0}, {0x2248, 197,   0}, {0x2260, 173,   0},
        {0x2264, 178,   1}
    };

    constexpr CodePageRange MAC_ICELAND_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 202,   0}, {0x00A1, 193,   0},
        {0x00A2, 162,   1}, {0x00A4, 219,   0}, {0x00A5, 180,   0},
        {0x00A7, 164,   0}, {0x00A8, 172,   0}, {0x00A9, 169,   0},
        {0x00AA, 187,   0}, {0x00AB, 199,   0}, {0x00AC, 194,   0},
        {0x00AE, 168,   0}, {0x00AF, 248,   0}, {0x00B0, 161,   0},
        {0x00B1, 177,   0}, {0x00B4, 171,   0}, {0x00B5, 181,   0},
        {0x00B6, 166,   0}, {0x00B7, 225,   0}, {0x00B8, 252,   0},
        {0x00BA, 188,   0}, {0x00BB, 200,   0}, {0x00BF, 192,   0},
        {0x00C0, 203,   0}, {0x00C1, 231,   0}, {0x00C2, 229,   0},
        {0x00C3, 204,   0}, {0x00C4, 128,   1}, {0x00C6, 174,   0},
        {0x00C7, 130,   0}, {0x00C8, 233,   0}, {0x00C9, 131,   0},
        {0x00CA, 230,   0}, {0x00CB, 232,   0}, {0x00CC, 237,   0},
        {0x00CD, 234,   2}, {0x00D0, 220,   0}, {0x00D1, 132,   0},
        {0x00D2, 241,   0}, {0x00D3, 238,   1}, {0x00D5, 205,   0},
        {0x00D6, 133,   0}, {0x00D8, 175,   0}, {0x00D9, 244,   0},
        {0x00DA, 242,   1}, {0x00DC, 134,   0}, {0x00DD, 160,   0},
        {0x00DE, 222,   0}, {0x00DF, 167,   0}, {0x00E0, 136,   0},
        {0x00E1, 135,   0}, {0x00E2, 137,   0}, {0x00E3, 139,   0},
        {0x00E4, 138,   0}, {0x00E5, 140,   0}, {0x00E6, 190,   0},
        {0x00E7, 141,   0}, {0x00E8, 143,   0}, {0x00E9, 142,   0},
        {0x00EA, 144,   1}, {0x00EC, 147,   0}, {0x00ED, 146,   0},
        {0x00EE, 148,   1}, {0x00F0, 221,   0}, {0x00F1, 150,   0},
        {0x00F2, 152,   0}, {0x00F3, 151,   0}, {0x00F4, 153,   0},
        {0x00F5, 155,   0}, {0x00F6, 154,   0}, {0x00F7, 214,   0},
        {0x00F8, 191,   0}, {0x00F9, 157,   0}, {0x00FA, 156,   0},
        {0x00FB, 158,   1}, {0x00FD, 224,   0}, {0x00FE, 223,   0},
        {0x00FF, 216,   0}, {0x0131, 245,   0}, {0x0152, 206,   1},
        {0x0178, 217,   0}, {0x0192, 196,   0}, {0x02C6, 246,   0},
        {0x02C7, 255,   0}, {0x02D8, 249,   2}, {0x02DB, 254,   0},
        {0x02DC, 247,   0}, {0x02DD, 253,   0}, {0x03C0, 185,   0},
        {0x2013, 208,   1}, {0x2018, 212,   1}, {0x201A, 226,   0},
        {0x201C, 210,   1}, {0x201E, 227,   0}, {0x2022, 165,   0},
        {0x2026, 201,   0}, {0x2030, 228,   0}, {0x2044, 218,   0},
        {0x2122, 170,   0}, {0x2126, 189,   0}, {0x2202, 182,   0},
        {0x2206, 198,   0}, {0x220F, 184,   0}, {0x2211, 183,   0},
        {0x221A, 195,   0}, {0x221E, 176,   0}, {0x222B, 186,   0},
        {0x2248, 197,   0}, {0x2260, 173,   0}, {0x2264, 178,   1},
        {0x25CA, 215,   0}
    };

    constexpr CodePageRange MAC_LATIN2_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 202,   0}, {0x00A3, 163,   0},
        {0x00A7, 164,   0}, {0x00A8, 172,   0}, {0x00A9, 169,   0},
        {0x00AB, 199,   0}, {0x00AC, 194,   0}, {0x00AE, 168,   0},
        {0x00B0, 161,   0}, {0x00B6, 166,   0}, {0x00BB, 200,   0},
        {0x00C1, 231,   0}, {0x00C4, 128,   0}, {0x00C9, 131,   0},
        {0x00CD, 234,   0}, {0x00D3, 238,   1}, {0x00D5, 205,   0},
        {0x00D6, 133,   0}, {0x00DA, 242,   0}, {0x00DC, 134,   0},
        {0x00DD, 248,   0}, {0x00DF, 167,   0}, {0x00E1, 135,   0},
        {0x00E4, 138,   0}, {0x00E9, 142,   0}, {0x00ED, 146,   0},
        {0x00F3, 151,   0}, {0x00F4, 153,   0}, {0x00F5, 155,   0},
        {0x00F6, 154,   0}, {0x00F7, 214,   0}, {0x00FA, 156,   0},
        {0x00FC, 159,   0}, {0x00FD, 249,   0}, {0x0100, 129,   1},
        {0x0104, 132,   0}, {0x0105, 136,   0}, {0x0106, 140,   1},
        {0x010C, 137,   0}, {0x010D, 139,   0}, {0x010E, 145,   0},
        {0x010F, 147,   0}, {0x0112, 148,   1}, {0x0116, 150,   0},
        {0x0117, 152,   0}, {0x0118, 162,   0}, {0x0119, 171,   0},
        {0x011A, 157,   1}, {0x0122, 254,   0}, {0x0123, 174,   0},
        {0x012A, 177,   0}, {0x012B, 180,   0}, {0x012E, 175,   1},
        {0x0136, 181,   0}, {0x0137, 250,   0}, {0x0139, 189,   1},
        {0x013B, 185,   3}, {0x0141, 252,   0}, {0x0142, 184,   0},
        {0x0143, 193,   0}, {0x0144, 196,   0}, {0x0145, 191,   1},
        {0x0147, 197,   0}, {0x0148, 203,   0}, {0x014C, 207,   0},
        {0x014D, 216,   0}, {0x0150, 204,   0}, {0x0151, 206,   0},
        {0x0154, 217,   1}, {0x0156, 223,   1}, {0x0158, 219,   0},
        {0x0159, 222,   0}, {0x015A, 229,   1}, {0x0160, 225,   0},
        {0x0161, 228,   0}, {0x0164, 232,   1}, {0x016A, 237,   0},
        {0x016B, 240,   0}, {0x016E, 241,   0}, {0x016F, 243,   4},
        {0x0179, 143,   1}, {0x017B, 251,   0}, {0x017C, 253,   0},
        {0x017D, 235,   1}, {0x02C7, 255,   0}, {0x2013, 208,   1},
        {0x2018, 212,   1}, {0x201A, 226,   0}, {0x201C, 210,   1},
        {0x201E, 227,   0}, {0x2020, 160,   0}, {0x2022, 165,   0},
        {0x2026, 201,   0}, {0x2039, 220,   1}, {0x2122, 170,   0},
        {0x2202, 182,   0}, {0x2206, 198,   0}, {0x2211, 183,   0},
        {0x221A, 195,   0}, {0x2260, 173,   0}, {0x2264, 178,   1},
        {0x25CA, 215,   0}
    };

    constexpr CodePageRange MAC_ROMAN_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 202,   0}, {0x00A1, 193,   0},
        {0x00A2, 162,   1}, {0x00A4, 219,   0}, {0x00A5, 180,   0},
        {0x00A7, 164,   0}, {0x00A8, 172,   0}, {0x00A9, 169,   0},
        {0x00AA, 187,   0}, {0x00AB, 199,   0}, {0x00AC, 194,   0},
        {0x00AE, 168,   0}, {0x00AF, 248,   0}, {0x00B0, 161,   0},
        {0x00B1, 177,   0}, {0x00B4, 171,   0}, {0x00B5, 181,   0},
        {0x00B6, 166,   0}, {0x00B7, 225,   0}, {0x00B8, 252,   0},
        {0x00BA, 188,   0}, {0x00BB, 200,   0}, {0x00BF, 192,   0},
        {0x00C0, 203,   0}, {0x00C1, 231,   0}, {0x00C2, 229,   0},
        {0x00C3, 204,   0}, {0x00C4, 128,   1}, {0x00C6, 174,   0},
        {0x00C7, 130,   0}, {0x00C8, 233,   0}, {0x00C9, 131,   0},
        {0x00CA, 230,   0}, {0x00CB, 232,   0}, {0x00CC, 237,   0},
        {0x00CD, 234,   2}, {0x00D1, 132,   0}, {0x00D2, 241,   0},
        {0x00D3, 238,   1}, {0x00D5, 205,   0}, {0x00D6, 133,   0},
        {0x00D8, 175,   0}, {0x00D9, 244,   0}, {0x00DA, 242,   1},
        {0x00DC, 134,   0}, {0x00DF, 167,   0}, {0x00E0, 136,   0},
        {0x00E1, 135,   0}, {0x00E2, 137,   0}, {0x00E3, 139,   0},
        {0x00E4, 138,   0}, {0x00E5, 140,   0}, {0x00E6, 190,   0},
        {0x00E7, 141,   0}, {0x00E8, 143,   0}, {0x00E9, 142,   0},
        {0x00EA, 144,   1}, {0x00EC, 147,   0}, {0x00ED, 146,   0},
        {0x00EE, 148,   1}, {0x00F1, 150,   0}, {0x00F2, 152,   0},
        {0x00F3, 151,   0}, {0x00F4, 153,   0}, {0x00F5, 155,   0},
        {0x00F6, 154,   0}, {0x00F7, 214,   0}, {0x00F8, 191,   0},
        {0x00F9, 157,   0}, {0x00FA, 156,   0}, {0x00FB, 158,   1},
        {0x00FF, 216,   0}, {0x0131, 245,   0}, {0x0152, 206,   1},
        {0x0178, 217,   0}, {0x0192, 196,   0}, {0x02C6, 246,   0},
        {0x02C7, 255,   0}, {0x02D8, 249,   2}, {0x02DB, 254,   0},
        {0x02DC, 247,   0}, {0x02DD, 253,   0}, {0x03C0, 185,   0},
        {0x2013, 208,   1}, {0x2018, 212,   1}, {0x201A, 226,   0},
        {0x201C, 210,   1}, {0x201E, 227,   0}, {0x2020, 160,   0},
        {0x2021, 224,   0}, {0x2022, 165,   0}, {0x2026, 201,   0},
        {0x2030, 228,   0}, {0x2039, 220,   1}, {0x2044, 218,   0},
        {0x2122, 170,   0}, {0x2126, 189,   0}, {0x2202, 182,   0},
        {0x2206, 198,   0}, {0x220F, 184,   0}, {0x2211, 183,   0},
        {0x221A, 195,   0}, {0x221E, 176,   0}, {0x222B, 186,   0},
        {0x2248, 197,   0}, {0x2260, 173,   0}, {0x2264, 178,   1},
        {0x25CA, 215,   0}, {0xFB01, 222,   1}
    };

    constexpr CodePageRange MAC_TURKISH_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 202,   0}, {0x00A1, 193,   0},
        {0x00A2, 162,   1}, {0x00A5, 180,   0}, {0x00A7, 164,   0},
        {0x00A8, 172,   0}, {0x00A9, 169,   0}, {0x00AA, 187,   0},
        {0x00AB, 199,   0}, {0x00AC, 194,   0}, {0x00AE, 168,   0},
        {0x00AF, 248,   0}, {0x00B0, 161,   0}, {0x00B1, 177,   0},
        {0x00B4, 171,   0}, {0x00B5, 181,   0}, {0x00B6, 166,   0},
        {0x00B7, 225,   0}, {0x00B8, 252,   0}, {0x00BA, 188,   0},
        {0x00BB, 200,   0}, {0x00BF, 192,   0}, {0x00C0, 203,   0},
        {0x00C1, 231,   0}, {0x00C2, 229,   0}, {0x00C3, 204,   0},
        {0x00C4, 128,   1}, {0x00C6, 174,   0}, {0x00C7, 130,   0},
        {0x00C8, 233,   0}, {0x00C9, 131,   0}, {0x00CA, 230,   0},
        {0x00CB, 232,   0}, {0x00CC, 237,   0}, {0x00CD, 234,   2},
        {0x00D1, 132,   0}, {0x00D2, 241,   0}, {0x00D3, 238,   1},
        {0x00D5, 205,   0}, {0x00D6, 133,   0}, {0x00D8, 175,   0},
        {0x00D9, 244,   0}, {0x00DA, 242,   1}, {0x00DC, 134,   0},
        {0x00DF, 167,   0}, {0x00E0, 136,   0}, {0x00E1, 135,   0},
        {0x00E2, 137,   0}, {0x00E3, 139,   0}, {0x00E4, 138,   0},
        {0x00E5, 140,   0}, {0x00E6, 190,   0}, {0x00E7, 141,   0},
        {0x00E8, 143,   0}, {0x00E9, 142,   0}, {0x00EA, 144,   1},
        {0x00EC, 147,   0}, {0x00ED, 146,   0}, {0x00EE, 148,   1},
        {0x00F1, 150,   0}, {0x00F2, 152,   0}, {0x00F3, 151,   0},
        {0x00F4, 153,   0}, {0x00F5, 155,   0}, {0x00F6, 154,   0},
        {0x00F7, 214,   0}, {0x00F8, 191,   0}, {0x00F9, 157,   0},
        {0x00FA, 156,   0}, {0x00FB, 158,   1}, {0x00FF, 216,   0},
        {0x011E, 218,   1}, {0x0130, 220,   1}, {0x0152, 206,   1},
        {0x015E, 222,   1}, {0x0178, 217,   0}, {0x0192, 196,   0},
        {0x02C6, 246,   0}, {0x02C7, 255,   0}, {0x02D8, 249,   2},
        {0x02DB, 254,   0}, {0x02DC, 247,   0}, {0x02DD, 253,   0},
        {0x03C0, 185,   0}, {0x2013, 208,   1}, {0x2018, 212,   1},
        {0x201A, 226,   0}, {0x201C, 210,   1}, {0x201E, 227,   0},
        {0x2020, 160,   0}, {0x2021, 224,   0}, {0x2022, 165,   0},
        {0x2026, 201,   0}, {0x2030, 228,   0}, {0x2122, 170,   0},
        {0x2126, 189,   0}, {0x2202, 182,   0}, {0x2206, 198,   0},
        {0x220F, 184,   0}, {0x2211, 183,   0}, {0x221A, 195,   0},
        {0x221E, 176,   0}, {0x222B, 186,   0}, {0x2248, 197,   0},
        {0x2260, 173,   0}, {0x2264, 178,   1}, {0x25CA, 215,   0}
    };

    inline std::pair<const CodePageRange*, size_t>
    getMacCodePageRanges(Encoding encoding)
    {
        switch (encoding)
        {
        case Encoding::MAC_CYRILLIC:
            return {MAC_CYRILLIC_CHARS, std::size(MAC_CYRILLIC_CHARS)};
        case Encoding::MAC_GREEK:
            return {MAC_GREEK_CHARS, std::size(MAC_GREEK_CHARS)};
        case Encoding::MAC_ICELAND:
            return {MAC_ICELAND_CHARS, std::size(MAC_ICELAND_CHARS)};
        case Encoding::MAC_LATIN2:
            return {MAC_LATIN2_CHARS, std::size(MAC_LATIN2_CHARS)};
        case Encoding::MAC_ROMAN:
            return {MAC_ROMAN_CHARS, std::size(MAC_ROMAN_CHARS)};
        case Encoding::MAC_TURKISH:
            return {MAC_TURKISH_CHARS, std::size(MAC_TURKISH_CHARS)};
        default:
            return {nullptr, 0};
        }
    }

    #endif

    #ifdef YCONVERT_ENABLE_DOS_CODE_PAGES

    constexpr CodePageRange DOS_CP437_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 255,   0}, {0x00A1, 173,   0},
        {0x00A2, 155,   1}, {0x00A5, 157,   0}, {0x00AA, 166,   0},
        {0x00AB, 174,   0}, {0x00AC, 170,   0}, {0x00B0, 248,   0},
        {0x00B1, 241,   0}, {0x00B2, 253,   0}, {0x00B5, 230,   0},
        {0x00B7, 250,   0}, {0x00BA, 167,   0}, {0x00BB, 175,   0},
        {0x00BC, 172,   0}, {0x00BD, 171,   0}, {0x00BF, 168,   0},
        {0x00C4, 142,   1}, {0x00C6, 146,   0}, {0x00C7, 128,   0},
        {0x00C9, 144,   0}, {0x00D1, 165,   0}, {0x00D6, 153,   0},
        {0x00DC, 154,   0}, {0x00DF, 225,   0}, {0x00E0, 133,   0},
        {0x00E1, 160,   0}, {0x00E2, 131,   0}, {0x00E4, 132,   0},
        {0x00E5, 134,   0}, {0x00E6, 145,   0}, {0x00E7, 135,   0},
        {0x00E8, 138,   0}, {0x00E9, 130,   0}, {0x00EA, 136,   1},
        {0x00EC, 141,   0}, {0x00ED, 161,   0}, {0x00EE, 140,   0},
        {0x00EF, 139,   0}, {0x00F1, 164,   0}, {0x00F2, 149,   0},
        {0x00F3, 162,   0}, {0x00F4, 147,   0}, {0x00F6, 148,   0},
        {0x00F7, 246,   0}, {0x00F9, 151,   0}, {0x00FA, 163,   0},
        {0x00FB, 150,   0}, {0x00FC, 129,   0}, {0x00FF, 152,   0},
        {0x0192, 159,   0}, {0x0393, 226,   0}, {0x0398, 233,   0},
        {0x03A3, 228,   0}, {0x03A6, 232,   0}, {0x03A9, 234,   0},
        {0x03B1, 224,   0}, {0x03B4, 235,   0}, {0x03B5, 238,   0},
        {0x03C0, 227,   0}, {0x03C3, 229,   0}, {0x03C4, 231,   0},
        {0x03C6, 237,   0}, {0x207F, 252,   0}, {0x20A7, 158,   0},
        {0x2219, 249,   0}, {0x221A, 251,   0}, {0x221E, 236,   0},
        {0x2229, 239,   0}, {0x2248, 247,   0}, {0x2261, 240,   0},
        {0x2264, 243,   0}, {0x2265, 242,   0}, {0x2310, 169,   0},
        {0x2320, 244,   1}, {0x2500, 196,   0}, {0x2502, 179,   0},
        {0x250C, 218,   0}, {0x2510, 191,   0}, {0x2514, 192,   0},
        {0x2518, 217,   0}, {0x251C, 195,   0}, {0x2524, 180,   0},
        {0x252C, 194,   0}, {0x2534, 193,   0}, {0x253C, 197,   0},
        {0x2550, 205,   0}, {0x2551, 186,   0}, {0x2552, 213,   1},
        {0x2554, 201,   0}, {0x2555, 184,   0}, {0x2556, 183,   0},
        {0x2557, 187,   0}, {0x2558, 212,   0}, {0x2559, 211,   0},
        {0x255A, 200,   0}, {0x255B, 190,   0}, {0x255C, 189,   0},
        {0x255D, 188,   0}, {0x255E, 198,   1}, {0x2560, 204,   0},
        {0x2561, 181,   1}, {0x2563, 185,   0}, {0x2564, 209,   1},
        {0x2566, 203,   0}, {0x2567, 207,   1}, {0x2569, 202,   0},
        {0x256A, 216,   0}, {0x256B, 215,   0}, {0x256C, 206,   0},
        {0x2580, 223,   0}, {0x2584, 220,   0}, {0x2588, 219,   0},
        {0x258C, 221,   0}, {0x2590, 222,   0}, {0x2591, 176,   2},
        {0x25A0, 254,   0}
    };

    constexpr CodePageRange DOS_CP737_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 255,   0}, {0x00B0, 248,   0},
        {0x00B1, 241,   0}, {0x00B2, 253,   0}, {0x00B7, 250,   0},
        {0x00F7, 246,   0}, {0x0386, 234,   0}, {0x0388, 235,   2},
        {0x038C, 238,   0}, {0x038E, 239,   1}, {0x0391, 128,  16},
        {0x03A3, 145,   6}, {0x03AA, 244,   1}, {0x03AC, 225,   2},
        {0x03AF, 229,   0}, {0x03B1, 152,  16}, {0x03C2, 170,   0},
        {0x03C3, 169,   0}, {0x03C4, 171,   4}, {0x03C9, 224,   0},
        {0x03CA, 228,   0}, {0x03CB, 232,   0}, {0x03CC, 230,   1},
        {0x03CE, 233,   0}, {0x207F, 252,   0}, {0x2219, 249,   0},
        {0x221A, 251,   0}, {0x2248, 247,   0}, {0x2264, 243,   0},
        {0x2265, 242,   0}, {0x2500, 196,   0}, {0x2502, 179,   0},
        {0x250C, 218,   0}, {0x2510, 191,   0}, {0x2514, 192,   0},
        {0x2518, 217,   0}, {0x251C, 195,   0}, {0x2524, 180,   0},
        {0x252C, 194,   0}, {0x2534, 193,   0}, {0x253C, 197,   0},
        {0x2550, 205,   0}, {0x2551, 186,   0}, {0x2552, 213,   1},
        {0x2554, 201,   0}, {0x2555, 184,   0}, {0x2556, 183,   0},
        {0x2557, 187,   0}, {0x2558, 212,   0}, {0x2559, 211,   0},
        {0x255A, 200,   0}, {0x255B, 190,   0}, {0x255C, 189,   0},
        {0x255D, 188,   0}, {0x255E, 198,   1}, {0x2560, 204,   0},
        {0x2561, 181,   1}, {0x2563, 185,   0}, {0x2564, 209,   1},
        {0x2566, 203,   0}, {0x2567, 207,   1}, {0x2569, 202,   0},
        {0x256A, 216,   0}, {0x256B, 215,   0}, {0x256C, 206,   0},
        {0x2580, 223,   0}, {0x2584, 220,   0}, {0x2588, 219,   0},
        {0x258C, 221,   0}, {0x2590, 222,   0}, {0x2591, 176,   2},
        {0x25A0, 254,   0}
    };

    constexpr CodePageRange DOS_CP775_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 255,   0}, {0x00A2, 150,   0},
        {0x00A3, 156,   0}, {0x00A4, 159,   0}, {0x00A6, 167,   0},
        {0x00A7, 245,   0}, {0x00A9, 168,   0}, {0x00AB, 174,   0},
        {0x00AC, 170,   0}, {0x00AD, 240,   0}, {0x00AE, 169,   0},
        {0x00B0, 248,   0}, {0x00B1, 241,   0}, {0x00B2, 253,   0},
        {0x00B3, 252,   0}, {0x00B5, 230,   0}, {0x00B6, 244,   0},
        {0x00B7, 250,   0}, {0x00B9, 251,   0}, {0x00BB, 175,   0},
        {0x00BC, 172,   0}, {0x00BD, 171,   0}, {0x00BE, 243,   0},
        {0x00C4, 142,   1}, {0x00C6, 146,   0}, {0x00C9, 144,   0},
        {0x00D3, 224,   0}, {0x00D5, 229,   0}, {0x00D6, 153,   0},
        {0x00D7, 158,   0}, {0x00D8, 157,   0}, {0x00DC, 154,   0},
        {0x00DF, 225,   0}, {0x00E4, 132,   0}, {0x00E5, 134,   0},
        {0x00E6, 145,   0}, {0x00E9, 130,   0}, {0x00F3, 162,   0},
        {0x00F5, 228,   0}, {0x00F6, 148,   0}, {0x00F7, 246,   0},
        {0x00F8, 155,   0}, {0x00FC, 129,   0}, {0x0100, 160,   0},
        {0x0101, 131,   0}, {0x0104, 181,   0}, {0x0105, 208,   0},
        {0x0106, 128,   0}, {0x0107, 135,   0}, {0x010C, 182,   0},
        {0x010D, 209,   0}, {0x0112, 237,   0}, {0x0113, 137,   0},
        {0x0116, 184,   0}, {0x0117, 211,   0}, {0x0118, 183,   0},
        {0x0119, 210,   0}, {0x0122, 149,   0}, {0x0123, 133,   0},
        {0x012A, 161,   0}, {0x012B, 140,   0}, {0x012E, 189,   0},
        {0x012F, 212,   0}, {0x0136, 232,   1}, {0x013B, 234,   1},
        {0x0141, 173,   0}, {0x0142, 136,   0}, {0x0143, 227,   0},
        {0x0144, 231,   0}, {0x0145, 238,   0}, {0x0146, 236,   0},
        {0x014C, 226,   0}, {0x014D, 147,   0}, {0x0156, 138,   1},
        {0x015A, 151,   1}, {0x0160, 190,   0}, {0x0161, 213,   0},
        {0x016A, 199,   0}, {0x016B, 215,   0}, {0x0172, 198,   0},
        {0x0173, 214,   0}, {0x0179, 141,   0}, {0x017A, 165,   0},
        {0x017B, 163,   1}, {0x017D, 207,   0}, {0x017E, 216,   0},
        {0x2019, 239,   0}, {0x201C, 242,   0}, {0x201D, 166,   0},
        {0x201E, 247,   0}, {0x2219, 249,   0}, {0x2500, 196,   0},
        {0x2502, 179,   0}, {0x250C, 218,   0}, {0x2510, 191,   0},
        {0x2514, 192,   0}, {0x2518, 217,   0}, {0x251C, 195,   0},
        {0x2524, 180,   0}, {0x252C, 194,   0}, {0x2534, 193,   0},
        {0x253C, 197,   0}, {0x2550, 205,   0}, {0x2551, 186,   0},
        {0x2554, 201,   0}, {0x2557, 187,   0}, {0x255A, 200,   0},
        {0x255D, 188,   0}, {0x2560, 204,   0}, {0x2563, 185,   0},
        {0x2566, 203,   0}, {0x2569, 202,   0}, {0x256C, 206,   0},
        {0x2580, 223,   0}, {0x2584, 220,   0}, {0x2588, 219,   0},
        {0x258C, 221,   0}, {0x2590, 222,   0}, {0x2591, 176,   2},
        {0x25A0, 254,   0}
    };

    constexpr CodePageRange DOS_CP850_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 255,   0}, {0x00A1, 173,   0},
        {0x00A2, 189,   0}, {0x00A3, 156,   0}, {0x00A4, 207,   0},
        {0x00A5, 190,   0}, {0x00A6, 221,   0}, {0x00A7, 245,   0},
        {0x00A8, 249,   0}, {0x00A9, 184,   0}, {0x00AA, 166,   0},
        {0x00AB, 174,   0}, {0x00AC, 170,   0}, {0x00AD, 240,   0},
        {0x00AE, 169,   0}, {0x00AF, 238,   0}, {0x00B0, 248,   0},
        {0x00B1, 241,   0}, {0x00B2, 253,   0}, {0x00B3, 252,   0},
        {0x00B4, 239,   0}, {0x00B5, 230,   0}, {0x00B6, 244,   0},
        {0x00B7, 250,   0}, {0x00B8, 247,   0}, {0x00B9, 251,   0},
        {0x00BA, 167,   0}, {0x00BB, 175,   0}, {0x00BC, 172,   0},
        {0x00BD, 171,   0}, {0x00BE, 243,   0}, {0x00BF, 168,   0},
        {0x00C0, 183,   0}, {0x00C1, 181,   1}, {0x00C3, 199,   0},
        {0x00C4, 142,   1}, {0x00C6, 146,   0}, {0x00C7, 128,   0},
        {0x00C8, 212,   0}, {0x00C9, 144,   0}, {0x00CA, 210,   1},
        {0x00CC, 222,   0}, {0x00CD, 214,   2}, {0x00D0, 209,   0},
        {0x00D1, 165,   0}, {0x00D2, 227,   0}, {0x00D3, 224,   0},
        {0x00D4, 226,   0}, {0x00D5, 229,   0}, {0x00D6, 153,   0},
        {0x00D7, 158,   0}, {0x00D8, 157,   0}, {0x00D9, 235,   0},
        {0x00DA, 233,   1}, {0x00DC, 154,   0}, {0x00DD, 237,   0},
        {0x00DE, 232,   0}, {0x00DF, 225,   0}, {0x00E0, 133,   0},
        {0x00E1, 160,   0}, {0x00E2, 131,   0}, {0x00E3, 198,   0},
        {0x00E4, 132,   0}, {0x00E5, 134,   0}, {0x00E6, 145,   0},
        {0x00E7, 135,   0}, {0x00E8, 138,   0}, {0x00E9, 130,   0},
        {0x00EA, 136,   1}, {0x00EC, 141,   0}, {0x00ED, 161,   0},
        {0x00EE, 140,   0}, {0x00EF, 139,   0}, {0x00F0, 208,   0},
        {0x00F1, 164,   0}, {0x00F2, 149,   0}, {0x00F3, 162,   0},
        {0x00F4, 147,   0}, {0x00F5, 228,   0}, {0x00F6, 148,   0},
        {0x00F7, 246,   0}, {0x00F8, 155,   0}, {0x00F9, 151,   0},
        {0x00FA, 163,   0}, {0x00FB, 150,   0}, {0x00FC, 129,   0},
        {0x00FD, 236,   0}, {0x00FE, 231,   0}, {0x00FF, 152,   0},
        {0x0131, 213,   0}, {0x0192, 159,   0}, {0x2017, 242,   0},
        {0x2500, 196,   0}, {0x2502, 179,   0}, {0x250C, 218,   0},
        {0x2510, 191,   0}, {0x2514, 192,   0}, {0x2518, 217,   0},
        {0x251C, 195,   0}, {0x2524, 180,   0}, {0x252C, 194,   0},
        {0x2534, 193,   0}, {0x253C, 197,   0}, {0x2550, 205,   0},
        {0x2551, 186,   0}, {0x2554, 201,   0}, {0x2557, 187,   0},
        {0x255A, 200,   0}, {0x255D, 188,   0}, {0x2560, 204,   0},
        {0x2563, 185,   0}, {0x2566, 203,   0}, {0x2569, 202,   0},
        {0x256C, 206,   0}, {0x2580, 223,   0}, {0x2584, 220,   0},
        {0x2588, 219,   0}, {0x2591, 176,   2}, {0x25A0, 254,   0}
    };

    constexpr CodePageRange DOS_CP852_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 255,   0}, {0x00A4, 207,   0},
        {0x00A7, 245,   0}, {0x00A8, 249,   0}, {0x00AB, 174,   0},
        {0x00AC, 170,   0}, {0x00AD, 240,   0}, {0x00B0, 248,   0},
        {0x00B4, 239,   0}, {0x00B8, 247,   0}, {0x00BB, 175,   0},
        {0x00C1, 181,   1}, {0x00C4, 142,   0}, {0x00C7, 128,   0},
        {0x00C9, 144,   0}, {0x00CB, 211,   0}, {0x00CD, 214,   1},
        {0x00D3, 224,   0}, {0x00D4, 226,   0}, {0x00D6, 153,   0},
        {0x00D7, 158,   0}, {0x00DA, 233,   0}, {0x00DC, 154,   0},
        {0x00DD, 237,   0}, {0x00DF, 225,   0}, {0x00E1, 160,   0},
        {0x00E2, 131,   0}, {0x00E4, 132,   0}, {0x00E7, 135,   0},
        {0x00E9, 130,   0}, {0x00EB, 137,   0}, {0x00ED, 161,   0},
        {0x00EE, 140,   0}, {0x00F3, 162,   0}, {0x00F4, 147,   0},
        {0x00F6, 148,   0}, {0x00F7, 246,   0}, {0x00FA, 163,   0},
        {0x00FC, 129,   0}, {0x00FD, 236,   0}, {0x0102, 198,   1},
        {0x0104, 164,   1}, {0x0106, 143,   0}, {0x0107, 134,   0},
        {0x010C, 172,   0}, {0x010D, 159,   0}, {0x010E, 210,   0},
        {0x010F, 212,   0}, {0x0110, 209,   0}, {0x0111, 208,   0},
        {0x0118, 168,   1}, {0x011A, 183,   0}, {0x011B, 216,   0},
        {0x0139, 145,   1}, {0x013D, 149,   1}, {0x0141, 157,   0},
        {0x0142, 136,   0}, {0x0143, 227,   1}, {0x0147, 213,   0},
        {0x0148, 229,   0}, {0x0150, 138,   1}, {0x0154, 232,   0},
        {0x0155, 234,   0}, {0x0158, 252,   1}, {0x015A, 151,   1},
        {0x015E, 184,   0}, {0x015F, 173,   0}, {0x0160, 230,   1},
        {0x0162, 221,   0}, {0x0163, 238,   0}, {0x0164, 155,   1},
        {0x016E, 222,   0}, {0x016F, 133,   0}, {0x0170, 235,   0},
        {0x0171, 251,   0}, {0x0179, 141,   0}, {0x017A, 171,   0},
        {0x017B, 189,   1}, {0x017D, 166,   1}, {0x02C7, 243,   0},
        {0x02D8, 244,   0}, {0x02D9, 250,   0}, {0x02DB, 242,   0},
        {0x02DD, 241,   0}, {0x2500, 196,   0}, {0x2502, 179,   0},
        {0x250C, 218,   0}, {0x2510, 191,   0}, {0x2514, 192,   0},
        {0x2518, 217,   0}, {0x251C, 195,   0}, {0x2524, 180,   0},
        {0x252C, 194,   0}, {0x2534, 193,   0}, {0x253C, 197,   0},
        {0x2550, 205,   0}, {0x2551, 186,   0}, {0x2554, 201,   0},
        {0x2557, 187,   0}, {0x255A, 200,   0}, {0x255D, 188,   0},
        {0x2560, 204,   0}, {0x2563, 185,   0}, {0x2566, 203,   0},
        {0x2569, 202,   0}, {0x256C, 206,   0}, {0x2580, 223,   0},
        {0x2584, 220,   0}, {0x2588, 219,   0}, {0x2591, 176,   2},
        {0x25A0, 254,   0}
    };

    constexpr CodePageRange DOS_CP855_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 255,   0}, {0x00A4, 207,   0},
        {0x00A7, 253,   0}, {0x00AB, 174,   0}, {0x00AD, 240,   0},
        {0x00BB, 175,   0}, {0x0401, 133,   0}, {0x0402, 129,   0},
        {0x0403, 131,   0}, {0x0404, 135,   0}, {0x0405, 137,   0},
        {0x0406, 139,   0}, {0x0407, 141,   0}, {0x0408, 143,   0},
        {0x0409, 145,   0}, {0x040A, 147,   0}, {0x040B, 149,   0},
        {0x040C, 151,   0}, {0x040E, 153,   0}, {0x040F, 155,   0},
        {0x0410, 161,   0}, {0x0411, 163,   0}, {0x0412, 236,   0},
        {0x0413, 173,   0}, {0x0414, 167,   0}, {0x0415, 169,   0},
        {0x0416, 234,   0}, {0x0417, 244,   0}, {0x0418, 184,   0},
        {0x0419, 190,   0}, {0x041A, 199,   0}, {0x041B, 209,   0},
        {0x041C, 211,   0}, {0x041D, 213,   0}, {0x041E, 215,   0},
        {0x041F, 221,   0}, {0x0420, 226,   0}, {0x0421, 228,   0},
        {0x0422, 230,   0}, {0x0423, 232,   0}, {0x0424, 171,   0},
        {0x0425, 182,   0}, {0x0426, 165,   0}, {0x0427, 252,   0},
        {0x0428, 246,   0}, {0x0429, 250,   0}, {0x042A, 159,   0},
        {0x042B, 242,   0}, {0x042C, 238,   0}, {0x042D, 248,   0},
        {0x042E, 157,   0}, {0x042F, 224,   0}, {0x0430, 160,   0},
        {0x0431, 162,   0}, {0x0432, 235,   0}, {0x0433, 172,   0},
        {0x0434, 166,   0}, {0x0435, 168,   0}, {0x0436, 233,   0},
        {0x0437, 243,   0}, {0x0438, 183,   0}, {0x0439, 189,   0},
        {0x043A, 198,   0}, {0x043B, 208,   0}, {0x043C, 210,   0},
        {0x043D, 212,   0}, {0x043E, 214,   0}, {0x043F, 216,   0},
        {0x0440, 225,   0}, {0x0441, 227,   0}, {0x0442, 229,   0},
        {0x0443, 231,   0}, {0x0444, 170,   0}, {0x0445, 181,   0},
        {0x0446, 164,   0}, {0x0447, 251,   0}, {0x0448, 245,   0},
        {0x0449, 249,   0}, {0x044A, 158,   0}, {0x044B, 241,   0},
        {0x044C, 237,   0}, {0x044D, 247,   0}, {0x044E, 156,   0},
        {0x044F, 222,   0}, {0x0451, 132,   0}, {0x0452, 128,   0},
        {0x0453, 130,   0}, {0x0454, 134,   0}, {0x0455, 136,   0},
        {0x0456, 138,   0}, {0x0457, 140,   0}, {0x0458, 142,   0},
        {0x0459, 144,   0}, {0x045A, 146,   0}, {0x045B, 148,   0},
        {0x045C, 150,   0}, {0x045E, 152,   0}, {0x045F, 154,   0},
        {0x2116, 239,   0}, {0x2500, 196,   0}, {0x2502, 179,   0},
        {0x250C, 218,   0}, {0x2510, 191,   0}, {0x2514, 192,   0},
        {0x2518, 217,   0}, {0x251C, 195,   0}, {0x2524, 180,   0},
        {0x252C, 194,   0}, {0x2534, 193,   0}, {0x253C, 197,   0},
        {0x2550, 205,   0}, {0x2551, 186,   0}, {0x2554, 201,   0},
        {0x2557, 187,   0}, {0x255A, 200,   0}, {0x255D, 188,   0},
        {0x2560, 204,   0}, {0x2563, 185,   0}, {0x2566, 203,   0},
        {0x2569, 202,   0}, {0x256C, 206,   0}, {0x2580, 223,   0},
        {0x2584, 220,   0}, {0x2588, 219,   0}, {0x2591, 176,   2},
        {0x25A0, 254,   0}
    };

    constexpr CodePageRange DOS_CP857_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 255,   0}, {0x00A1, 173,   0},
        {0x00A2, 189,   0}, {0x00A3, 156,   0}, {0x00A4, 207,   0},
        {0x00A5, 190,   0}, {0x00A6, 221,   0}, {0x00A7, 245,   0},
        {0x00A8, 249,   0}, {0x00A9, 184,   0}, {0x00AA, 209,   0},
        {0x00AB, 174,   0}, {0x00AC, 170,   0}, {0x00AD, 240,   0},
        {0x00AE, 169,   0}, {0x00AF, 238,   0}, {0x00B0, 248,   0},
        {0x00B1, 241,   0}, {0x00B2, 253,   0}, {0x00B3, 252,   0},
        {0x00B4, 239,   0}, {0x00B5, 230,   0}, {0x00B6, 244,   0},
        {0x00B7, 250,   0}, {0x00B8, 247,   0}, {0x00B9, 251,   0},
        {0x00BA, 208,   0}, {0x00BB, 175,   0}, {0x00BC, 172,   0},
        {0x00BD, 171,   0}, {0x00BE, 243,   0}, {0x00BF, 168,   0},
        {0x00C0, 183,   0}, {0x00C1, 181,   1}, {0x00C3, 199,   0},
        {0x00C4, 142,   1}, {0x00C6, 146,   0}, {0x00C7, 128,   0},
        {0x00C8, 212,   0}, {0x00C9, 144,   0}, {0x00CA, 210,   1},
        {0x00CC, 222,   0}, {0x00CD, 214,   2}, {0x00D1, 165,   0},
        {0x00D2, 227,   0}, {0x00D3, 224,   0}, {0x00D4, 226,   0},
        {0x00D5, 229,   0}, {0x00D6, 153,   0}, {0x00D7, 232,   0},
        {0x00D8, 157,   0}, {0x00D9, 235,   0}, {0x00DA, 233,   1},
        {0x00DC, 154,   0}, {0x00DF, 225,   0}, {0x00E0, 133,   0},
        {0x00E1, 160,   0}, {0x00E2, 131,   0}, {0x00E3, 198,   0},
        {0x00E4, 132,   0}, {0x00E5, 134,   0}, {0x00E6, 145,   0},
        {0x00E7, 135,   0}, {0x00E8, 138,   0}, {0x00E9, 130,   0},
        {0x00EA, 136,   1}, {0x00EC, 236,   0}, {0x00ED, 161,   0},
        {0x00EE, 140,   0}, {0x00EF, 139,   0}, {0x00F1, 164,   0},
        {0x00F2, 149,   0}, {0x00F3, 162,   0}, {0x00F4, 147,   0},
        {0x00F5, 228,   0}, {0x00F6, 148,   0}, {0x00F7, 246,   0},
        {0x00F8, 155,   0}, {0x00F9, 151,   0}, {0x00FA, 163,   0},
        {0x00FB, 150,   0}, {0x00FC, 129,   0}, {0x00FF, 237,   0},
        {0x011E, 166,   1}, {0x0130, 152,   0}, {0x0131, 141,   0},
        {0x015E, 158,   1}, {0x2500, 196,   0}, {0x2502, 179,   0},
        {0x250C, 218,   0}, {0x2510, 191,   0}, {0x2514, 192,   0},
        {0x2518, 217,   0}, {0x251C, 195,   0}, {0x2524, 180,   0},
        {0x252C, 194,   0}, {0x2534, 193,   0}, {0x253C, 197,   0},
        {0x2550, 205,   0}, {0x2551, 186,   0}, {0x2554, 201,   0},
        {0x2557, 187,   0}, {0x255A, 200,   0}, {0x255D, 188,   0},
        {0x2560, 204,   0}, {0x2563, 185,   0}, {0x2566, 203,   0},
        {0x2569, 202,   0}, {0x256C, 206,   0}, {0x2580, 223,   0},
        {0x2584, 220,   0}, {0x2588, 219,   0}, {0x2591, 176,   2},
        {0x25A0, 254,   0}
    };

    constexpr CodePageRange DOS_CP860_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 255,   0}, {0x00A1, 173,   0},
        {0x00A2, 155,   1}, {0x00AA, 166,   0}, {0x00AB, 174,   0},
        {0x00AC, 170,   0}, {0x00B0, 248,   0}, {0x00B1, 241,   0},
        {0x00B2, 253,   0}, {0x00B5, 230,   0}, {0x00B7, 250,   0},
        {0x00BA, 167,   0}, {0x00BB, 175,   0}, {0x00BC, 172,   0},
        {0x00BD, 171,   0}, {0x00BF, 168,   0}, {0x00C0, 145,   0},
        {0x00C1, 134,   0}, {0x00C2, 143,   0}, {0x00C3, 142,   0},
        {0x00C7, 128,   0}, {0x00C8, 146,   0}, {0x00C9, 144,   0},
        {0x00CA, 137,   0}, {0x00CC, 152,   0}, {0x00CD, 139,   0},
        {0x00D1, 165,   0}, {0x00D2, 169,   0}, {0x00D3, 159,   0},
        {0x00D4, 140,   0}, {0x00D5, 153,   0}, {0x00D9, 157,   0},
        {0x00DA, 150,   0}, {0x00DC, 154,   0}, {0x00DF, 225,   0},
        {0x00E0, 133,   0}, {0x00E1, 160,   0}, {0x00E2, 131,   1},
        {0x00E7, 135,   0}, {0x00E8, 138,   0}, {0x00E9, 130,   0},
        {0x00EA, 136,   0}, {0x00EC, 141,   0}, {0x00ED, 161,   0},
        {0x00F1, 164,   0}, {0x00F2, 149,   0}, {0x00F3, 162,   0},
        {0x00F4, 147,   1}, {0x00F7, 246,   0}, {0x00F9, 151,   0},
        {0x00FA, 163,   0}, {0x00FC, 129,   0}, {0x0393, 226,   0},
        {0x0398, 233,   0}, {0x03A3, 228,   0}, {0x03A6, 232,   0},
        {0x03A9, 234,   0}, {0x03B1, 224,   0}, {0x03B4, 235,   0},
        {0x03B5, 238,   0}, {0x03C0, 227,   0}, {0x03C3, 229,   0},
        {0x03C4, 231,   0}, {0x03C6, 237,   0}, {0x207F, 252,   0},
        {0x20A7, 158,   0}, {0x2219, 249,   0}, {0x221A, 251,   0},
        {0x221E, 236,   0}, {0x2229, 239,   0}, {0x2248, 247,   0},
        {0x2261, 240,   0}, {0x2264, 243,   0}, {0x2265, 242,   0},
        {0x2320, 244,   1}, {0x2500, 196,   0}, {0x2502, 179,   0},
        {0x250C, 218,   0}, {0x2510, 191,   0}, {0x2514, 192,   0},
        {0x2518, 217,   0}, {0x251C, 195,   0}, {0x2524, 180,   0},
        {0x252C, 194,   0}, {0x2534, 193,   0}, {0x253C, 197,   0},
        {0x2550, 205,   0}, {0x2551, 186,   0}, {0x2552, 213,   1},
        {0x2554, 201,   0}, {0x2555, 184,   0}, {0x2556, 183,   0},
        {0x2557, 187,   0}, {0x2558, 212,   0}, {0x2559, 211,   0},
        {0x255A, 200,   0}, {0x255B, 190,   0}, {0x255C, 189,   0},
        {0x255D, 188,   0}, {0x255E, 198,   1}, {0x2560, 204,   0},
        {0x2561, 181,   1}, {0x2563, 185,   0}, {0x2564, 209,   1},
        {0x2566, 203,   0}, {0x2567, 207,   1}, {0x2569, 202,   0},
        {0x256A, 216,   0}, {0x256B, 215,   0}, {0x256C, 206,   0},
        {0x2580, 223,   0}, {0x2584, 220,   0}, {0x2588, 219,   0},
        {0x258C, 221,   0}, {0x2590, 222,   0}, {0x2591, 176,   2},
        {0x25A0, 254,   0}
    };

    constexpr CodePageRange DOS_CP861_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 255,   0}, {0x00A1, 173,   0},
        {0x00A3, 156,   0}, {0x00AB, 174,   0}, {0x00AC, 170,   0},
        {0x00B0, 248,   0}, {0x00B1, 241,   0}, {0x00B2, 253,   0},
        {0x00B5, 230,   0}, {0x00B7, 250,   0}, {0x00BB, 175,   0},
        {0x00BC, 172,   0}, {0x00BD, 171,   0}, {0x00BF, 168,   0},
        {0x00C1, 164,   0}, {0x00C4, 142,   1}, {0x00C6, 146,   0},
        {0x00C7, 128,   0}, {0x00C9, 144,   0}, {0x00CD, 165,   0},
        {0x00D0, 139,   0}, {0x00D3, 166,   0}, {0x00D6, 153,   0},
        {0x00D8, 157,   0}, {0x00DA, 167,   0}, {0x00DC, 154,   0},
        {0x00DD, 151,   0}, {0x00DE, 141,   0}, {0x00DF, 225,   0},
        {0x00E0, 133,   0}, {0x00E1, 160,   0}, {0x00E2, 131,   0},
        {0x00E4, 132,   0}, {0x00E5, 134,   0}, {0x00E6, 145,   0},
        {0x00E7, 135,   0}, {0x00E8, 138,   0}, {0x00E9, 130,   0},
        {0x00EA, 136,   1}, {0x00ED, 161,   0}, {0x00F0, 140,   0},
        {0x00F3, 162,   0}, {0x00F4, 147,   0}, {0x00F6, 148,   0},
        {0x00F7, 246,   0}, {0x00F8, 155,   0}, {0x00FA, 163,   0},
        {0x00FB, 150,   0}, {0x00FC, 129,   0}, {0x00FD, 152,   0},
        {0x00FE, 149,   0}, {0x0192, 159,   0}, {0x0393, 226,   0},
        {0x0398, 233,   0}, {0x03A3, 228,   0}, {0x03A6, 232,   0},
        {0x03A9, 234,   0}, {0x03B1, 224,   0}, {0x03B4, 235,   0},
        {0x03B5, 238,   0}, {0x03C0, 227,   0}, {0x03C3, 229,   0},
        {0x03C4, 231,   0}, {0x03C6, 237,   0}, {0x207F, 252,   0},
        {0x20A7, 158,   0}, {0x2219, 249,   0}, {0x221A, 251,   0},
        {0x221E, 236,   0}, {0x2229, 239,   0}, {0x2248, 247,   0},
        {0x2261, 240,   0}, {0x2264, 243,   0}, {0x2265, 242,   0},
        {0x2310, 169,   0}, {0x2320, 244,   1}, {0x2500, 196,   0},
        {0x2502, 179,   0}, {0x250C, 218,   0}, {0x2510, 191,   0},
        {0x2514, 192,   0}, {0x2518, 217,   0}, {0x251C, 195,   0},
        {0x2524, 180,   0}, {0x252C, 194,   0}, {0x2534, 193,   0},
        {0x253C, 197,   0}, {0x2550, 205,   0}, {0x2551, 186,   0},
        {0x2552, 213,   1}, {0x2554, 201,   0}, {0x2555, 184,   0},
        {0x2556, 183,   0}, {0x2557, 187,   0}, {0x2558, 212,   0},
        {0x2559, 211,   0}, {0x255A, 200,   0}, {0x255B, 190,   0},
        {0x255C, 189,   0}, {0x255D, 188,   0}, {0x255E, 198,   1},
        {0x2560, 204,   0}, {0x2561, 181,   1}, {0x2563, 185,   0},
        {0x2564, 209,   1}, {0x2566, 203,   0}, {0x2567, 207,   1},
        {0x2569, 202,   0}, {0x256A, 216,   0}, {0x256B, 215,   0},
        {0x256C, 206,   0}, {0x2580, 223,   0}, {0x2584, 220,   0},
        {0x2588, 219,   0}, {0x258C, 221,   0}, {0x2590, 222,   0},
        {0x2591, 176,   2}, {0x25A0, 254,   0}
    };

    constexpr CodePageRange DOS_CP862_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 255,   0}, {0x00A1, 173,   0},
        {0x00A2, 155,   1}, {0x00A5, 157,   0}, {0x00AA, 166,   0},
        {0x00AB, 174,   0}, {0x00AC, 170,   0}, {0x00B0, 248,   0},
        {0x00B1, 241,   0}, {0x00B2, 253,   0}, {0x00B5, 230,   0},
        {0x00B7, 250,   0}, {0x00BA, 167,   0}, {0x00BB, 175,   0},
        {0x00BC, 172,   0}, {0x00BD, 171,   0}, {0x00BF, 168,   0},
        {0x00D1, 165,   0}, {0x00DF, 225,   0}, {0x00E1, 160,   0},
        {0x00ED, 161,   0}, {0x00F1, 164,   0}, {0x00F3, 162,   0},
        {0x00F7, 246,   0}, {0x00FA, 163,   0}, {0x0192, 159,   0},
        {0x0393, 226,   0}, {0x0398, 233,   0}, {0x03A3, 228,   0},
        {0x03A6, 232,   0}, {0x03A9, 234,   0}, {0x03B1, 224,   0},
        {0x03B4, 235,   0}, {0x03B5, 238,   0}, {0x03C0, 227,   0},
        {0x03C3, 229,   0}, {0x03C4, 231,   0}, {0x03C6, 237,   0},
        {0x05D0, 128,  26}, {0x207F, 252,   0}, {0x20A7, 158,   0},
        {0x2219, 249,   0}, {0x221A, 251,   0}, {0x221E, 236,   0},
        {0x2229, 239,   0}, {0x2248, 247,   0}, {0x2261, 240,   0},
        {0x2264, 243,   0}, {0x2265, 242,   0}, {0x2310, 169,   0},
        {0x2320, 244,   1}, {0x2500, 196,   0}, {0x2502, 179,   0},
        {0x250C, 218,   0}, {0x2510, 191,   0}, {0x2514, 192,   0},
        {0x2518, 217,   0}, {0x251C, 195,   0}, {0x2524, 180,   0},
        {0x252C, 194,   0}, {0x2534, 193,   0}, {0x253C, 197,   0},
        {0x2550, 205,   0}, {0x2551, 186,   0}, {0x2552, 213,   1},
        {0x2554, 201,   0}, {0x2555, 184,   0}, {0x2556, 183,   0},
        {0x2557, 187,   0}, {0x2558, 212,   0}, {0x2559, 211,   0},
        {0x255A, 200,   0}, {0x255B, 190,   0}, {0x255C, 189,   0},
        {0x255D, 188,   0}, {0x255E, 198,   1}, {0x2560, 204,   0},
        {0x2561, 181,   1}, {0x2563, 185,   0}, {0x2564, 209,   1},
        {0x2566, 203,   0}, {0x2567, 207,   1}, {0x2569, 202,   0},
        {0x256A, 216,   0}, {0x256B, 215,   0}, {0x256C, 206,   0},
        {0x2580, 223,   0}, {0x2584, 220,   0}, {0x2588, 219,   0},
        {0x258C, 221,   0}, {0x2590, 222,   0}, {0x2591, 176,   2},
        {0x25A0, 254,   0}
    };

    constexpr CodePageRange DOS_CP863_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 255,   0}, {0x00A2, 155,   1},
        {0x00A4, 152,   0}, {0x00A6, 160,   0}, {0x00A7, 143,   0},
        {0x00A8, 164,   0}, {0x00AB, 174,   0}, {0x00AC, 170,   0},
        {0x00AF, 167,   0}, {0x00B0, 248,   0}, {0x00B1, 241,   0},
        {0x00B2, 253,   0}, {0x00B3, 166,   0}, {0x00B4, 161,   0},
        {0x00B5, 230,   0}, {0x00B6, 134,   0}, {0x00B7, 250,   0},
        {0x00B8, 165,   0}, {0x00BB, 175,   0}, {0x00BC, 172,   0},
        {0x00BD, 171,   0}, {0x00BE, 173,   0}, {0x00C0, 142,   0},
        {0x00C2, 132,   0}, {0x00C7, 128,   0}, {0x00C8, 145,   0},
        {0x00C9, 144,   0}, {0x00CA, 146,   0}, {0x00CB, 148,   0},
        {0x00CE, 168,   0}, {0x00CF, 149,   0}, {0x00D4, 153,   0},
        {0x00D9, 157,   0}, {0x00DB, 158,   0}, {0x00DC, 154,   0},
        {0x00DF, 225,   0}, {0x00E0, 133,   0}, {0x00E2, 131,   0},
        {0x00E7, 135,   0}, {0x00E8, 138,   0}, {0x00E9, 130,   0},
        {0x00EA, 136,   1}, {0x00EE, 140,   0}, {0x00EF, 139,   0},
        {0x00F3, 162,   0}, {0x00F4, 147,   0}, {0x00F7, 246,   0},
        {0x00F9, 151,   0}, {0x00FA, 163,   0}, {0x00FB, 150,   0},
        {0x00FC, 129,   0}, {0x0192, 159,   0}, {0x0393, 226,   0},
        {0x0398, 233,   0}, {0x03A3, 228,   0}, {0x03A6, 232,   0},
        {0x03A9, 234,   0}, {0x03B1, 224,   0}, {0x03B4, 235,   0},
        {0x03B5, 238,   0}, {0x03C0, 227,   0}, {0x03C3, 229,   0},
        {0x03C4, 231,   0}, {0x03C6, 237,   0}, {0x2017, 141,   0},
        {0x207F, 252,   0}, {0x2219, 249,   0}, {0x221A, 251,   0},
        {0x221E, 236,   0}, {0x2229, 239,   0}, {0x2248, 247,   0},
        {0x2261, 240,   0}, {0x2264, 243,   0}, {0x2265, 242,   0},
        {0x2310, 169,   0}, {0x2320, 244,   1}, {0x2500, 196,   0},
        {0x2502, 179,   0}, {0x250C, 218,   0}, {0x2510, 191,   0},
        {0x2514, 192,   0}, {0x2518, 217,   0}, {0x251C, 195,   0},
        {0x2524, 180,   0}, {0x252C, 194,   0}, {0x2534, 193,   0},
        {0x253C, 197,   0}, {0x2550, 205,   0}, {0x2551, 186,   0},
        {0x2552, 213,   1}, {0x2554, 201,   0}, {0x2555, 184,   0},
        {0x2556, 183,   0}, {0x2557, 187,   0}, {0x2558, 212,   0},
        {0x2559, 211,   0}, {0x255A, 200,   0}, {0x255B, 190,   0},
        {0x255C, 189,   0}, {0x255D, 188,   0}, {0x255E, 198,   1},
        {0x2560, 204,   0}, {0x2561, 181,   1}, {0x2563, 185,   0},
        {0x2564, 209,   1}, {0x2566, 203,   0}, {0x2567, 207,   1},
        {0x2569, 202,   0}, {0x256A, 216,   0}, {0x256B, 215,   0},
        {0x256C, 206,   0}, {0x2580, 223,   0}, {0x2584, 220,   0},
        {0x2588, 219,   0}, {0x258C, 221,   0}, {0x2590, 222,   0},
        {0x2591, 176,   2}, {0x25A0, 254,   0}
    };

    constexpr CodePageRange DOS_CP864_CHARS[] = {
        {0x0000,   0,  36}, {0x0026,  38,  89}, {0x00A0, 160,   0},
        {0x00A2, 192,   0}, {0x00A3, 163,   1}, {0x00A6, 219,   0},
        {0x00AB, 151,   0}, {0x00AC, 220,   0}, {0x00AD, 161,   0},
        {0x00B0, 128,   0}, {0x00B1, 147,   0}, {0x00B7, 129,   0},
        {0x00BB, 152,   0}, {0x00BC, 149,   0}, {0x00BD, 148,   0},
        {0x00D7, 222,   0}, {0x00F7, 221,   0}, {0x03B2, 144,   0},
        {0x03C6, 146,   0}, {0x060C, 172,   0}, {0x061B, 187,   0},
        {0x061F, 191,   0}, {0x0640, 224,   0}, {0x0651, 241,   0},
        {0x0660, 176,   9}, {0x066A,  37,   0}, {0x2219, 130,   1},
        {0x221E, 145,   0}, {0x2248, 150,   0}, {0x2500, 133,   0},
        {0x2502, 134,   0}, {0x250C, 141,   0}, {0x2510, 140,   0},
        {0x2514, 142,   0}, {0x2518, 143,   0}, {0x251C, 138,   0},
        {0x2524, 136,   0}, {0x252C, 137,   0}, {0x2534, 139,   0},
        {0x253C, 135,   0}, {0x2592, 132,   0}, {0x25A0, 254,   0},
        {0xFE7D, 240,   0}, {0xFE80, 193,   1}, {0xFE82, 162,   0},
        {0xFE83, 195,   0}, {0xFE84, 165,   0}, {0xFE85, 196,   0},
        {0xFE8B, 198,   0}, {0xFE8D, 199,   0}, {0xFE8E, 168,   1},
        {0xFE91, 200,   0}, {0xFE93, 201,   0}, {0xFE95, 170,   0},
        {0xFE97, 202,   0}, {0xFE99, 171,   0}, {0xFE9B, 203,   0},
        {0xFE9D, 173,   0}, {0xFE9F, 204,   0}, {0xFEA1, 174,   0},
        {0xFEA3, 205,   0}, {0xFEA5, 175,   0}, {0xFEA7, 206,   0},
        {0xFEA9, 207,   0}, {0xFEAB, 208,   0}, {0xFEAD, 209,   0},
        {0xFEAF, 210,   0}, {0xFEB1, 188,   0}, {0xFEB3, 211,   0},
        {0xFEB5, 189,   0}, {0xFEB7, 212,   0}, {0xFEB9, 190,   0},
        {0xFEBB, 213,   0}, {0xFEBD, 235,   0}, {0xFEBF, 214,   0},
        {0xFEC1, 215,   0}, {0xFEC5, 216,   0}, {0xFEC9, 223,   0},
        {0xFECA, 197,   0}, {0xFECB, 217,   0}, {0xFECC, 236,   0},
        {0xFECD, 238,   0}, {0xFECE, 237,   0}, {0xFECF, 218,   0},
        {0xFED0, 247,   0}, {0xFED1, 186,   0}, {0xFED3, 225,   0},
        {0xFED5, 248,   0}, {0xFED7, 226,   0}, {0xFED9, 252,   0},
        {0xFEDB, 227,   0}, {0xFEDD, 251,   0}, {0xFEDF, 228,   0},
        {0xFEE1, 239,   0}, {0xFEE3, 229,   0}, {0xFEE5, 242,   0},
        {0xFEE7, 230,   0}, {0xFEE9, 243,   0}, {0xFEEB, 231,   0},
        {0xFEEC, 244,   0}, {0xFEED, 232,   0}, {0xFEEF, 233,   0},
        {0xFEF0, 245,   0}, {0xFEF1, 253,   0}, {0xFEF2, 246,   0},
        {0xFEF3, 234,   0}, {0xFEF5, 249,   1}, {0xFEF7, 153,   1},
        {0xFEFB, 157,   1}
    };

    constexpr CodePageRange DOS_CP865_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 255,   0}, {0x00A1, 173,   0},
        {0x00A3, 156,   0}, {0x00A4, 175,   0}, {0x00AA, 166,   0},
        {0x00AB, 174,   0}, {0x00AC, 170,   0}, {0x00B0, 248,   0},
        {0x00B1, 241,   0}, {0x00B2, 253,   0}, {0x00B5, 230,   0},
        {0x00B7, 250,   0}, {0x00BA, 167,   0}, {0x00BC, 172,   0},
        {0x00BD, 171,   0}, {0x00BF, 168,   0}, {0x00C4, 142,   1},
        {0x00C6, 146,   0}, {0x00C7, 128,   0}, {0x00C9, 144,   0},
        {0x00D1, 165,   0}, {0x00D6, 153,   0}, {0x00D8, 157,   0},
        {0x00DC, 154,   0}, {0x00DF, 225,   0}, {0x00E0, 133,   0},
        {0x00E1, 160,   0}, {0x00E2, 131,   0}, {0x00E4, 132,   0},
        {0x00E5, 134,   0}, {0x00E6, 145,   0}, {0x00E7, 135,   0},
        {0x00E8, 138,   0}, {0x00E9, 130,   0}, {0x00EA, 136,   1},
        {0x00EC, 141,   0}, {0x00ED, 161,   0}, {0x00EE, 140,   0},
        {0x00EF, 139,   0}, {0x00F1, 164,   0}, {0x00F2, 149,   0},
        {0x00F3, 162,   0}, {0x00F4, 147,   0}, {0x00F6, 148,   0},
        {0x00F7, 246,   0}, {0x00F8, 155,   0}, {0x00F9, 151,   0},
        {0x00FA, 163,   0}, {0x00FB, 150,   0}, {0x00FC, 129,   0},
        {0x00FF, 152,   0}, {0x0192, 159,   0}, {0x0393, 226,   0},
        {0x0398, 233,   0}, {0x03A3, 228,   0}, {0x03A6, 232,   0},
        {0x03A9, 234,   0}, {0x03B1, 224,   0}, {0x03B4, 235,   0},
        {0x03B5, 238,   0}, {0x03C0, 227,   0}, {0x03C3, 229,   0},
        {0x03C4, 231,   0}, {0x03C6, 237,   0}, {0x207F, 252,   0},
        {0x20A7, 158,   0}, {0x2219, 249,   0}, {0x221A, 251,   0},
        {0x221E, 236,   0}, {0x2229, 239,   0}, {0x2248, 247,   0},
        {0x2261, 240,   0}, {0x2264, 243,   0}, {0x2265, 242,   0},
        {0x2310, 169,   0}, {0x2320, 244,   1}, {0x2500, 196,   0},
        {0x2502, 179,   0}, {0x250C, 218,   0}, {0x2510, 191,   0},
        {0x2514, 192,   0}, {0x2518, 217,   0}, {0x251C, 195,   0},
        {0x2524, 180,   0}, {0x252C, 194,   0}, {0x2534, 193,   0},
        {0x253C, 197,   0}, {0x2550, 205,   0}, {0x2551, 186,   0},
        {0x2552, 213,   1}, {0x2554, 201,   0}, {0x2555, 184,   0},
        {0x2556, 183,   0}, {0x2557, 187,   0}, {0x2558, 212,   0},
        {0x2559, 211,   0}, {0x255A, 200,   0}, {0x255B, 190,   0},
        {0x255C, 189,   0}, {0x255D, 188,   0}, {0x255E, 198,   1},
        {0x2560, 204,   0}, {0x2561, 181,   1}, {0x2563, 185,   0},
        {0x2564, 209,   1}, {0x2566, 203,   0}, {0x2567, 207,   1},
        {0x2569, 202,   0}, {0x256A, 216,   0}, {0x256B, 215,   0},
        {0x256C, 206,   0}, {0x2580, 223,   0}, {0x2584, 220,   0},
        {0x2588, 219,   0}, {0x258C, 221,   0}, {0x2590, 222,   0},
        {0x2591, 176,   2}, {0x25A0, 254,   0}
    };

    constexpr CodePageRange DOS_CP866_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 255,   0}, {0x00A4, 253,   0},
        {0x00B0, 248,   0}, {0x00B7, 250,   0}, {0x0401, 240,   0},
        {0x0404, 242,   0}, {0x0407, 244,   0}, {0x040E, 246,   0},
        {0x0410, 128,  47}, {0x0440, 224,  15}, {0x0451, 241,   0},
        {0x0454, 243,   0}, {0x0457, 245,   0}, {0x045E, 247,   0},
        {0x2116, 252,   0}, {0x2219, 249,   0}, {0x221A, 251,   0},
        {0x2500, 196,   0}, {0x2502, 179,   0}, {0x250C, 218,   0},
        {0x2510, 191,   0}, {0x2514, 192,   0}, {0x2518, 217,   0},
        {0x251C, 195,   0}, {0x2524, 180,   0}, {0x252C, 194,   0},
        {0x2534, 193,   0}, {0x253C, 197,   0}, {0x2550, 205,   0},
        {0x2551, 186,   0}, {0x2552, 213,   1}, {0x2554, 201,   0},
        {0x2555, 184,   0}, {0x2556, 183,   0}, {0x2557, 187,   0},
        {0x2558, 212,   0}, {0x2559, 211,   0}, {0x255A, 200,   0},
        {0x255B, 190,   0}, {0x255C, 189,   0}, {0x255D, 188,   0},
        {0x255E, 198,   1}, {0x2560, 204,   0}, {0x2561, 181,   1},
        {0x2563, 185,   0}, {0x2564, 209,   1}, {0x2566, 203,   0},
        {0x2567, 207,   1}, {0x2569, 202,   0}, {0x256A, 216,   0},
        {0x256B, 215,   0}, {0x256C, 206,   0}, {0x2580, 223,   0},
        {0x2584, 220,   0}, {0x2588, 219,   0}, {0x258C, 221,   0},
        {0x2590, 222,   0}, {0x2591, 176,   2}, {0x25A0, 254,   0}
    };

    constexpr CodePageRange DOS_CP869_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 255,   0}, {0x00A3, 156,   0},
        {0x00A6, 138,   0}, {0x00A7, 245,   0}, {0x00A8, 249,   0},
        {0x00A9, 151,   0}, {0x00AB, 174,   0}, {0x00AC, 137,   0},
        {0x00AD, 240,   0}, {0x00B0, 248,   0}, {0x00B1, 241,   0},
        {0x00B2, 153,   1}, {0x00B7, 136,   0}, {0x00BB, 175,   0},
        {0x00BD, 171,   0}, {0x0384, 239,   0}, {0x0385, 247,   0},
        {0x0386, 134,   0}, {0x0388, 141,   0}, {0x0389, 143,   1},
        {0x038C, 146,   0}, {0x038E, 149,   0}, {0x038F, 152,   0},
        {0x0390, 161,   0}, {0x0391, 164,   6}, {0x0398, 172,   1},
        {0x039A, 181,   3}, {0x039E, 189,   1}, {0x03A0, 198,   1},
        {0x03A3, 207,   6}, {0x03AA, 145,   0}, {0x03AB, 150,   0},
        {0x03AC, 155,   0}, {0x03AD, 157,   2}, {0x03B0, 252,   0},
        {0x03B1, 214,   2}, {0x03B4, 221,   1}, {0x03B6, 224,  11},
        {0x03C2, 237,   0}, {0x03C3, 236,   0}, {0x03C4, 238,   0},
        {0x03C5, 242,   2}, {0x03C8, 246,   0}, {0x03C9, 250,   0},
        {0x03CA, 160,   0}, {0x03CB, 251,   0}, {0x03CC, 162,   1},
        {0x03CE, 253,   0}, {0x2015, 142,   0}, {0x2018, 139,   1},
        {0x2500, 196,   0}, {0x2502, 179,   0}, {0x250C, 218,   0},
        {0x2510, 191,   0}, {0x2514, 192,   0}, {0x2518, 217,   0},
        {0x251C, 195,   0}, {0x2524, 180,   0}, {0x252C, 194,   0},
        {0x2534, 193,   0}, {0x253C, 197,   0}, {0x2550, 205,   0},
        {0x2551, 186,   0}, {0x2554, 201,   0}, {0x2557, 187,   0},
        {0x255A, 200,   0}, {0x255D, 188,   0}, {0x2560, 204,   0},
        {0x2563, 185,   0}, {0x2566, 203,   0}, {0x2569, 202,   0},
        {0x256C, 206,   0}, {0x2580, 223,   0}, {0x2584, 220,   0},
        {0x2588, 219,   0}, {0x2591, 176,   2}, {0x25A0, 254,   0}
    };

    constexpr CodePageRange DOS_CP874_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 160,   0}, {0x0E01, 161,  57},
        {0x0E3F, 223,  28}, {0x2013, 150,   1}, {0x2018, 145,   1},
        {0x201C, 147,   1}, {0x2022, 149,   0}, {0x2026, 133,   0},
        {0x20AC, 128,   0}
    };

    inline std::pair<const CodePageRange*, size_t>
    getDosCodePageRanges(Encoding encoding)
    {
        switch (encoding)
        {
        case Encoding::DOS_CP437:
            return {DOS_CP437_CHARS, std::size(DOS_CP437_CHARS)};
        case Encoding::DOS_CP737:
            return {DOS_CP737_CHARS, std::size(DOS_CP737_CHARS)};
        case Encoding::DOS_CP775:
            return {DOS_CP775_CHARS, std::size(DOS_CP775_CHARS)};
        case Encoding::DOS_CP850:
            return {DOS_CP850_CHARS, std::size(DOS_CP850_CHARS)};
        case Encoding::DOS_CP852:
            return {DOS_CP852_CHARS, std::size(DOS_CP852_CHARS)};
        case Encoding::DOS_CP855:
            return {DOS_CP855_CHARS, std::size(DOS_CP855_CHARS)};
        case Encoding::DOS_CP857:
            return {DOS_CP857_CHARS, std::size(DOS_CP857_CHARS)};
        case Encoding::DOS_CP860:
            return {DOS_CP860_CHARS, std::size(DOS_CP860_CHARS)};
        case Encoding::DOS_CP861:
            return {DOS_CP861_CHARS, std::size(DOS_CP861_CHARS)};
        case Encoding::DOS_CP862:
            return {DOS_CP862_CHARS, std::size(DOS_CP862_CHARS)};
        case Encoding::DOS_CP863:
            return {DOS_CP863_CHARS, std::size(DOS_CP863_CHARS)};
        case Encoding::DOS_CP864:
            return {DOS_CP864_CHARS, std::size(DOS_CP864_CHARS)};
        case Encoding::DOS_CP865:
            return {DOS_CP865_CHARS, std::size(DOS_CP865_CHARS)};
        case Encoding::DOS_CP866:
            return {DOS_CP866_CHARS, std::size(DOS_CP866_CHARS)};
        case Encoding::DOS_CP869:
            return {DOS_CP869_CHARS, std::size(DOS_CP869_CHARS)};
        case Encoding::DOS_CP874:
            return {DOS_CP874_CHARS, std::size(DOS_CP874_CHARS)};
        default:
            return {nullptr, 0};
        }
    }

    #endif

    #ifdef YCONVERT_ENABLE_WIN_CODE_PAGES

    constexpr CodePageRange WIN_CP1250_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 160,   0}, {0x00A4, 164,   0},
        {0x00A6, 166,   3}, {0x00AB, 171,   3}, {0x00B0, 176,   1},
        {0x00B4, 180,   4}, {0x00BB, 187,   0}, {0x00C1, 193,   1},
        {0x00C4, 196,   0}, {0x00C7, 199,   0}, {0x00C9, 201,   0},
        {0x00CB, 203,   0}, {0x00CD, 205,   1}, {0x00D3, 211,   1},
        {0x00D6, 214,   1}, {0x00DA, 218,   0}, {0x00DC, 220,   1},
        {0x00DF, 223,   0}, {0x00E1, 225,   1}, {0x00E4, 228,   0},
        {0x00E7, 231,   0}, {0x00E9, 233,   0}, {0x00EB, 235,   0},
        {0x00ED, 237,   1}, {0x00F3, 243,   1}, {0x00F6, 246,   1},
        {0x00FA, 250,   0}, {0x00FC, 252,   1}, {0x0102, 195,   0},
        {0x0103, 227,   0}, {0x0104, 165,   0}, {0x0105, 185,   0},
        {0x0106, 198,   0}, {0x0107, 230,   0}, {0x010C, 200,   0},
        {0x010D, 232,   0}, {0x010E, 207,   0}, {0x010F, 239,   0},
        {0x0110, 208,   0}, {0x0111, 240,   0}, {0x0118, 202,   0},
        {0x0119, 234,   0}, {0x011A, 204,   0}, {0x011B, 236,   0},
        {0x0139, 197,   0}, {0x013A, 229,   0}, {0x013D, 188,   0},
        {0x013E, 190,   0}, {0x0141, 163,   0}, {0x0142, 179,   0},
        {0x0143, 209,   0}, {0x0144, 241,   0}, {0x0147, 210,   0},
        {0x0148, 242,   0}, {0x0150, 213,   0}, {0x0151, 245,   0},
        {0x0154, 192,   0}, {0x0155, 224,   0}, {0x0158, 216,   0},
        {0x0159, 248,   0}, {0x015A, 140,   0}, {0x015B, 156,   0},
        {0x015E, 170,   0}, {0x015F, 186,   0}, {0x0160, 138,   0},
        {0x0161, 154,   0}, {0x0162, 222,   0}, {0x0163, 254,   0},
        {0x0164, 141,   0}, {0x0165, 157,   0}, {0x016E, 217,   0},
        {0x016F, 249,   0}, {0x0170, 219,   0}, {0x0171, 251,   0},
        {0x0179, 143,   0}, {0x017A, 159,   0}, {0x017B, 175,   0},
        {0x017C, 191,   0}, {0x017D, 142,   0}, {0x017E, 158,   0},
        {0x02C7, 161,   0}, {0x02D8, 162,   0}, {0x02D9, 255,   0},
        {0x02DB, 178,   0}, {0x02DD, 189,   0}, {0x2013, 150,   1},
        {0x2018, 145,   1}, {0x201A, 130,   0}, {0x201C, 147,   1},
        {0x201E, 132,   0}, {0x2020, 134,   1}, {0x2022, 149,   0},
        {0x2026, 133,   0}, {0x2030, 137,   0}, {0x2039, 139,   0},
        {0x203A, 155,   0}, {0x20AC, 128,   0}, {0x2122, 153,   0}
    };

    constexpr CodePageRange WIN_CP1251_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 160,   0}, {0x00A4, 164,   0},
        {0x00A6, 166,   1}, {0x00A9, 169,   0}, {0x00AB, 171,   3},
        {0x00B0, 176,   1}, {0x00B5, 181,   2}, {0x00BB, 187,   0},
        {0x0401, 168,   0}, {0x0402, 128,   1}, {0x0404, 170,   0},
        {0x0405, 189,   0}, {0x0406, 178,   0}, {0x0407, 175,   0},
        {0x0408, 163,   0}, {0x0409, 138,   0}, {0x040A, 140,   0},
        {0x040B, 142,   0}, {0x040C, 141,   0}, {0x040E, 161,   0},
        {0x040F, 143,   0}, {0x0410, 192,  63}, {0x0451, 184,   0},
        {0x0452, 144,   0}, {0x0453, 131,   0}, {0x0454, 186,   0},
        {0x0455, 190,   0}, {0x0456, 179,   0}, {0x0457, 191,   0},
        {0x0458, 188,   0}, {0x0459, 154,   0}, {0x045A, 156,   0},
        {0x045B, 158,   0}, {0x045C, 157,   0}, {0x045E, 162,   0},
        {0x045F, 159,   0}, {0x0490, 165,   0}, {0x0491, 180,   0},
        {0x2013, 150,   1}, {0x2018, 145,   1}, {0x201A, 130,   0},
        {0x201C, 147,   1}, {0x201E, 132,   0}, {0x2020, 134,   1},
        {0x2022, 149,   0}, {0x2026, 133,   0}, {0x2030, 137,   0},
        {0x2039, 139,   0}, {0x203A, 155,   0}, {0x20AC, 136,   0},
        {0x2116, 185,   0}, {0x2122, 153,   0}
    };

    constexpr CodePageRange WIN_CP1252_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 160,  95}, {0x0152, 140,   0},
        {0x0153, 156,   0}, {0x0160, 138,   0}, {0x0161, 154,   0},
        {0x0178, 159,   0}, {0x017D, 142,   0}, {0x017E, 158,   0},
        {0x0192, 131,   0}, {0x02C6, 136,   0}, {0x02DC, 152,   0},
        {0x2013, 150,   1}, {0x2018, 145,   1}, {0x201A, 130,   0},
        {0x201C, 147,   1}, {0x201E, 132,   0}, {0x2020, 134,   1},
        {0x2022, 149,   0}, {0x2026, 133,   0}, {0x2030, 137,   0},
        {0x2039, 139,   0}, {0x203A, 155,   0}, {0x20AC, 128,   0},
        {0x2122, 153,   0}
    };

    constexpr CodePageRange WIN_CP1253_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 160,   0}, {0x00A3, 163,   6},
        {0x00AB, 171,   3}, {0x00B0, 176,   3}, {0x00B5, 181,   2},
        {0x00BB, 187,   0}, {0x00BD, 189,   0}, {0x0192, 131,   0},
        {0x0384, 180,   0}, {0x0385, 161,   1}, {0x0388, 184,   2},
        {0x038C, 188,   0}, {0x038E, 190,  19}, {0x03A3, 211,  43},
        {0x2013, 150,   1}, {0x2015, 175,   0}, {0x2018, 145,   1},
        {0x201A, 130,   0}, {0x201C, 147,   1}, {0x201E, 132,   0},
        {0x2020, 134,   1}, {0x2022, 149,   0}, {0x2026, 133,   0},
        {0x2030, 137,   0}, {0x2039, 139,   0}, {0x203A, 155,   0},
        {0x20AC, 128,   0}, {0x2122, 153,   0}
    };

    constexpr CodePageRange WIN_CP1254_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 160,  47}, {0x00D1, 209,  11},
        {0x00DF, 223,  16}, {0x00F1, 241,  11}, {0x00FF, 255,   0},
        {0x011E, 208,   0}, {0x011F, 240,   0}, {0x0130, 221,   0},
        {0x0131, 253,   0}, {0x0152, 140,   0}, {0x0153, 156,   0},
        {0x015E, 222,   0}, {0x015F, 254,   0}, {0x0160, 138,   0},
        {0x0161, 154,   0}, {0x0178, 159,   0}, {0x0192, 131,   0},
        {0x02C6, 136,   0}, {0x02DC, 152,   0}, {0x2013, 150,   1},
        {0x2018, 145,   1}, {0x201A, 130,   0}, {0x201C, 147,   1},
        {0x201E, 132,   0}, {0x2020, 134,   1}, {0x2022, 149,   0},
        {0x2026, 133,   0}, {0x2030, 137,   0}, {0x2039, 139,   0},
        {0x203A, 155,   0}, {0x20AC, 128,   0}, {0x2122, 153,   0}
    };

    constexpr CodePageRange WIN_CP1255_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 160,   3}, {0x00A5, 165,   4},
        {0x00AB, 171,  14}, {0x00BB, 187,   4}, {0x00D7, 170,   0},
        {0x00F7, 186,   0}, {0x0192, 131,   0}, {0x02C6, 136,   0},
        {0x02DC, 152,   0}, {0x05B0, 192,   9}, {0x05BB, 203,   8},
        {0x05D0, 224,  26}, {0x05F0, 212,   4}, {0x200E, 253,   1},
        {0x2013, 150,   1}, {0x2018, 145,   1}, {0x201A, 130,   0},
        {0x201C, 147,   1}, {0x201E, 132,   0}, {0x2020, 134,   1},
        {0x2022, 149,   0}, {0x2026, 133,   0}, {0x2030, 137,   0},
        {0x2039, 139,   0}, {0x203A, 155,   0}, {0x20AA, 164,   0},
        {0x20AC, 128,   0}, {0x2122, 153,   0}
    };

    constexpr CodePageRange WIN_CP1256_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 160,   0}, {0x00A2, 162,   7},
        {0x00AB, 171,  14}, {0x00BB, 187,   3}, {0x00D7, 215,   0},
        {0x00E0, 224,   0}, {0x00E2, 226,   0}, {0x00E7, 231,   4},
        {0x00EE, 238,   1}, {0x00F4, 244,   0}, {0x00F7, 247,   0},
        {0x00F9, 249,   0}, {0x00FB, 251,   1}, {0x0152, 140,   0},
        {0x0153, 156,   0}, {0x0192, 131,   0}, {0x02C6, 136,   0},
        {0x060C, 161,   0}, {0x061B, 186,   0}, {0x061F, 191,   0},
        {0x0621, 193,  21}, {0x0637, 216,   3}, {0x0640, 220,   3},
        {0x0644, 225,   0}, {0x0645, 227,   3}, {0x0649, 236,   1},
        {0x064B, 240,   3}, {0x064F, 245,   1}, {0x0651, 248,   0},
        {0x0652, 250,   0}, {0x0679, 138,   0}, {0x067E, 129,   0},
        {0x0686, 141,   0}, {0x0688, 143,   0}, {0x0691, 154,   0},
        {0x0698, 142,   0}, {0x06A9, 152,   0}, {0x06AF, 144,   0},
        {0x06BA, 159,   0}, {0x06BE, 170,   0}, {0x06C1, 192,   0},
        {0x06D2, 255,   0}, {0x200C, 157,   1}, {0x200E, 253,   1},
        {0x2013, 150,   1}, {0x2018, 145,   1}, {0x201A, 130,   0},
        {0x201C, 147,   1}, {0x201E, 132,   0}, {0x2020, 134,   1},
        {0x2022, 149,   0}, {0x2026, 133,   0}, {0x2030, 137,   0},
        {0x2039, 139,   0}, {0x203A, 155,   0}, {0x20AC, 128,   0},
        {0x2122, 153,   0}
    };

    constexpr CodePageRange WIN_CP1257_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 160,   0}, {0x00A2, 162,   2},
        {0x00A6, 166,   1}, {0x00A8, 141,   0}, {0x00A9, 169,   0},
        {0x00AB, 171,   3}, {0x00AF, 157,   0}, {0x00B0, 176,   7},
        {0x00B8, 143,   0}, {0x00B9, 185,   0}, {0x00BB, 187,   3},
        {0x00C4, 196,   1}, {0x00C6, 175,   0}, {0x00C9, 201,   0},
        {0x00D3, 211,   0}, {0x00D5, 213,   2}, {0x00D8, 168,   0},
        {0x00DC, 220,   0}, {0x00DF, 223,   0}, {0x00E4, 228,   1},
        {0x00E6, 191,   0}, {0x00E9, 233,   0}, {0x00F3, 243,   0},
        {0x00F5, 245,   2}, {0x00F8, 184,   0}, {0x00FC, 252,   0},
        {0x0100, 194,   0}, {0x0101, 226,   0}, {0x0104, 192,   0},
        {0x0105, 224,   0}, {0x0106, 195,   0}, {0x0107, 227,   0},
        {0x010C, 200,   0}, {0x010D, 232,   0}, {0x0112, 199,   0},
        {0x0113, 231,   0}, {0x0116, 203,   0}, {0x0117, 235,   0},
        {0x0118, 198,   0}, {0x0119, 230,   0}, {0x0122, 204,   0},
        {0x0123, 236,   0}, {0x012A, 206,   0}, {0x012B, 238,   0},
        {0x012E, 193,   0}, {0x012F, 225,   0}, {0x0136, 205,   0},
        {0x0137, 237,   0}, {0x013B, 207,   0}, {0x013C, 239,   0},
        {0x0141, 217,   0}, {0x0142, 249,   0}, {0x0143, 209,   0},
        {0x0144, 241,   0}, {0x0145, 210,   0}, {0x0146, 242,   0},
        {0x014C, 212,   0}, {0x014D, 244,   0}, {0x0156, 170,   0},
        {0x0157, 186,   0}, {0x015A, 218,   0}, {0x015B, 250,   0},
        {0x0160, 208,   0}, {0x0161, 240,   0}, {0x016A, 219,   0},
        {0x016B, 251,   0}, {0x0172, 216,   0}, {0x0173, 248,   0},
        {0x0179, 202,   0}, {0x017A, 234,   0}, {0x017B, 221,   0},
        {0x017C, 253,   0}, {0x017D, 222,   0}, {0x017E, 254,   0},
        {0x02C7, 142,   0}, {0x02D9, 255,   0}, {0x02DB, 158,   0},
        {0x2013, 150,   1}, {0x2018, 145,   1}, {0x201A, 130,   0},
        {0x201C, 147,   1}, {0x201E, 132,   0}, {0x2020, 134,   1},
        {0x2022, 149,   0}, {0x2026, 133,   0}, {0x2030, 137,   0},
        {0x2039, 139,   0}, {0x203A, 155,   0}, {0x20AC, 128,   0},
        {0x2122, 153,   0}
    };

    constexpr CodePageRange WIN_CP1258_CHARS[] = {
        {0x0000,   0, 127}, {0x00A0, 160,  34}, {0x00C4, 196,   7},
        {0x00CD, 205,   2}, {0x00D1, 209,   0}, {0x00D3, 211,   1},
        {0x00D6, 214,   6}, {0x00DF, 223,   3}, {0x00E4, 228,   7},
        {0x00ED, 237,   2}, {0x00F1, 241,   0}, {0x00F3, 243,   1},
        {0x00F6, 246,   6}, {0x00FF, 255,   0}, {0x0102, 195,   0},
        {0x0103, 227,   0}, {0x0110, 208,   0}, {0x0111, 240,   0},
        {0x0152, 140,   0}, {0x0153, 156,   0}, {0x0178, 159,   0},
        {0x0192, 131,   0}, {0x01A0, 213,   0}, {0x01A1, 245,   0},
        {0x01AF, 221,   0}, {0x01B0, 253,   0}, {0x02C6, 136,   0},
        {0x02DC, 152,   0}, {0x0300, 204,   0}, {0x0301, 236,   0},
        {0x0303, 222,   0}, {0x0309, 210,   0}, {0x0323, 242,   0},
        {0x2013, 150,   1}, {0x2018, 145,   1}, {0x201A, 130,   0},
        {0x201C, 147,   1}, {0x201E, 132,   0}, {0x2020, 134,   1},
        {0x2022, 149,   0}, {0x2026, 133,   0}, {0x2030, 137,   0},
        {0x2039, 139,   0}, {0x203A, 155,   0}, {0x20AB, 254,   0},
        {0x20AC, 128,   0}, {0x2122, 153,   0}
    };

    inline std::pair<const CodePageRange*, size_t>
    getWinCodePageRanges(Encoding encoding)
    {
        switch (encoding)
        {
        case Encoding::WIN_CP1250:
            return {WIN_CP1250_CHARS, std::size(WIN_CP1250_CHARS)};
        case Encoding::WIN_CP1251:
            return {WIN_CP1251_CHARS, std::size(WIN_CP1251_CHARS)};
        case Encoding::WIN_CP1252:
            return {WIN_CP1252_CHARS, std::size(WIN_CP1252_CHARS)};
        case Encoding::WIN_CP1253:
            return {WIN_CP1253_CHARS, std::size(WIN_CP1253_CHARS)};
        case Encoding::WIN_CP1254:
            return {WIN_CP1254_CHARS, std::size(WIN_CP1254_CHARS)};
        case Encoding::WIN_CP1255:
            return {WIN_CP1255_CHARS, std::size(WIN_CP1255_CHARS)};
        case Encoding::WIN_CP1256:
            return {WIN_CP1256_CHARS, std::size(WIN_CP1256_CHARS)};
        case Encoding::WIN_CP1257:
            return {WIN_CP1257_CHARS, std::size(WIN_CP1257_CHARS)};
        case Encoding::WIN_CP1258:
            return {WIN_CP1258_CHARS, std::size(WIN_CP1258_CHARS)};
        default:
            return {nullptr, 0};
        }
    }

    #endif
}

